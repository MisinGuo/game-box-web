# 前端技术架构设计文档

（SEO 内容站 + 应用型页面混合架构）

## 1. 项目背景与目标

### 1.1 项目背景

- 站点包含**海量 AI 生成文章**（攻略 / 资讯 / 文档）
- 对 SEO 要求极高（搜索引擎需直接获取完整 HTML）
- 同时包含 **盒子大全 / 游戏库 / 搜索 / 用户行为** 等应用型页面
- 文章页偏静态，功能页强依赖后端接口

### 1.2 核心目标

1. **文章页 100% 静态化（非动态渲染）**
2. 支撑 **10w+ / 100w+ 内容规模**
3. 支持 Markdown + 组件混排
4. 内容页与应用页 **同一工程统一维护**
5. 高性能、低维护成本、长期可扩展

------

## 2. 总体技术选型

### 2.1 核心框架

| 层级 | 技术                      |
| ---- | ------------------------- |
| 框架 | **Next.js（App Router）** |
| UI   | React 18                  |
| 内容 | Markdown / MDX            |
| 样式 | Tailwind CSS              |
| 构建 | SSG + ISR                 |
| 部署 | CDN + Serverless          |

👉 **定位**：
 Next.js = 高级静态站生成器 + Web App 框架

------

## 3. 渲染策略设计（SEO 核心）

### 3.1 页面渲染模式划分

| 页面类型   | 示例        | 渲染方式                |
| ---------- | ----------- | ----------------------- |
| 文章详情页 | 攻略 / 资讯 | **SSG / ISR（纯静态）** |
| 文章列表页 | 分类 / 标签 | SSG / ISR               |
| 游戏库     | 游戏列表    | SSR                     |
| 盒子大全   | 盒子聚合    | CSR / SSR               |
| 搜索页     | 搜索结果    | CSR                     |
| 用户中心   | 登录后      | CSR                     |

------

### 3.2 文章页静态化策略（强制）

```
// app/article/[slug]/page.tsx

export const dynamic = 'force-static'
export const revalidate = 86400 // ISR：24小时

export async function generateStaticParams() {
  return getAllArticleSlugs()
}
```

**保证：**

- 构建或首次访问生成 HTML
- CDN 直接缓存
- 搜索引擎无需执行 JS

------

## 4. 目录结构设计

```
app/
├─ article/
│  └─ [slug]/
│     └─ page.tsx        # 文章详情（SSG / ISR）
│
├─ games/
│  └─ page.tsx           # 游戏库（SSR）
│
├─ boxes/
│  └─ page.tsx           # 盒子大全
│
├─ search/
│  └─ page.tsx           # 搜索页（CSR）
│
├─ layout.tsx            # 全局布局
└─ page.tsx              # 首页
```

------

## 5. 内容系统设计（Markdown / MDX）

### 5.1 内容形态

- 内容来源：
  - 本地 Markdown
  - 或 CMS / 后端接口生成 Markdown
- 推荐使用 **MDX**，支持组件嵌入

### 5.2 MDX 示例

```
# 龙族重生2025：各职业高效输出手法全解析

<ArticleMeta />

<DownloadBox gameId="xxx" />

## 狂战（Berserker）
```

### 5.3 组件使用规范（SEO 安全）

**文章页中组件必须：**

- 不使用 `useEffect`
- 不访问 `window / document`
- 不依赖 cookie / 登录态
- 不强制 `use client`

👉 所有组件 **构建时渲染为 HTML**

------

## 6. SEO 设计规范

### 6.1 Metadata 管理

```
export async function generateMetadata({ params }) {
  const article = await getArticle(params.slug)
  return {
    title: article.title,
    description: article.desc,
    openGraph: { ... }
  }
}
```

### 6.2 SEO 强化点

- HTML 直出正文
- 语义化标签（h1-h6）
- 自动 TOC
- 内链系统
- JSON-LD（Article / Breadcrumb）

------

## 7. 大规模内容策略（10w+）

### 7.1 构建策略

| 策略     | 说明           |
| -------- | -------------- |
| ISR      | 避免全量 build |
| 分批生成 | 按访问生成     |
| CDN 缓存 | 命中静态 HTML  |
| 后台更新 | 不影响 SEO     |

### 7.2 内容更新流程

```
内容更新
  ↓
ISR 失效
  ↓
后台重新生成 HTML
  ↓
CDN 更新
```

------

## 8. 应用型页面架构

### 8.1 数据请求原则

| 场景        | 建议             |
| ----------- | ---------------- |
| 首屏数据    | SSR              |
| 筛选 / 分页 | CSR              |
| 登录态      | CSR              |
| 行为埋点    | Client Component |

### 8.2 示例

```
// app/games/page.tsx
const data = await fetch(API, { cache: 'no-store' })
```

------

## 9. 性能与安全

### 9.1 性能

- 静态内容 0 TTFB
- 图片懒加载
- 代码分包
- Edge CDN

### 9.2 SEO 安全红线（禁止）

- 文章页 CSR
- JS 渲染正文
- 客户端请求正文数据
- 登录态包裹文章内容

------

## 10. 总结（架构核心思想）

> **内容页：像 Hugo 一样静态**
>  **应用页：像 Web App 一样灵活**

Next.js 只是载体，
 真正的核心是 **渲染策略的严格划分**。