# æ•°æ®åº“è®¾è®¡æ–‡æ¡£

> ç‰ˆæœ¬ï¼šv2.7.0  
> æ—¥æœŸï¼š2025-12-14  
> é¡¹ç›®ï¼šå¤šäº§å“å†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆæ¸¸æˆç›’å­ / çŸ­å‰§æ¨å¹¿ï¼‰

---

## 1. æ•°æ®åº“æ¦‚è§ˆ

### 1.1 æ•°æ®åº“è§„åˆ’

| æ•°æ®åº“ | ç”¨é€” | å­—ç¬¦é›† |
|-------|------|--------|
| `ruoyi_system` | è‹¥ä¾ç³»ç»Ÿåº“ï¼ˆç”¨æˆ·ã€æƒé™ç­‰ï¼‰ | utf8mb4 |
| `product_content` | å†…å®¹ä¸šåŠ¡åº“ï¼ˆç½‘ç«™ã€äº§å“ã€æ–‡ç« ã€å­˜å‚¨ï¼‰ | utf8mb4 |
| `product_analytics` | ç»Ÿè®¡åˆ†æåº“ï¼ˆæ—¥å¿—ã€æŠ¥è¡¨ï¼‰ | utf8mb4 |

### 1.2 ç³»ç»Ÿæ¶æ„å›¾

```mermaid
flowchart TB
    subgraph ç½‘ç«™ç®¡ç†
        SITE[ç½‘ç«™ Sites]
    end
    
    subgraph äº§å“ç®¡ç†
        SITE --> GAMEBOX[æ¸¸æˆç›’å­]
        SITE --> GAME[æ¸¸æˆ]
        SITE --> DRAMA_VENDOR[çŸ­å‰§å‚å•†]
        SITE --> DRAMA[çŸ­å‰§]
        GAMEBOX <-->|å¤šå¯¹å¤š| GAME
        DRAMA_VENDOR -->|ä¸€å¯¹å¤š| DRAMA
    end
    
    subgraph å†…å®¹ç®¡ç†
        SITE --> ARTICLE[æ–‡ç« ]
        ARTICLE -->|å…³è”| GAME
        ARTICLE -->|å…³è”| GAMEBOX
        ARTICLE -->|å…³è”| DRAMA
        ARTICLE -->|ç”Ÿæˆ| AI_PLATFORM[AIå¹³å°]
    end
    
    subgraph å­˜å‚¨ç®¡ç†
        STORAGE[å¯¹è±¡å­˜å‚¨é…ç½®]
        STORAGE --> GITHUB[GitHubä»“åº“]
        STORAGE --> MINIO[MinIO]
        STORAGE --> R2[Cloudflare R2]
        ARTICLE --> STORAGE
        DOC[æ–‡æ¡£] --> STORAGE
    end
```

### 1.3 ER æ€»è§ˆå›¾

```mermaid
erDiagram
    %% ç½‘ç«™æ ¸å¿ƒ
    gb_sites ||--o{ gb_game_boxes : "æ‹¥æœ‰"
    gb_sites ||--o{ gb_games : "æ‹¥æœ‰"
    gb_sites ||--o{ gb_articles : "æ‹¥æœ‰"
    gb_sites ||--o{ gb_drama_vendors : "æ‹¥æœ‰"
    gb_sites ||--o{ gb_dramas : "æ‹¥æœ‰"
    gb_sites ||--o{ gb_prompt_templates : "æ‹¥æœ‰"
    
    %% æ¸¸æˆç›’å­-æ¸¸æˆå¤šå¯¹å¤šå…³ç³»
    gb_game_boxes ||--o{ gb_box_game_relations : "åŒ…å«æ¸¸æˆ"
    gb_games ||--o{ gb_box_game_relations : "è¢«ç›’å­æ”¶å½•"
    
    %% æ¸¸æˆç›¸å…³æ‰©å±•
    gb_games ||--o{ gb_game_activities : "æ´»åŠ¨"
    gb_games ||--o{ gb_game_servers : "å¼€æœ"
    gb_games ||--o{ gb_game_giftcodes : "ç¤¼åŒ…"
    gb_games ||--o{ gb_game_materials : "ç´ æ"
    
    %% æ–‡æ¡£ç›¸å…³
    gb_documents ||--o{ gb_document_game_relations : "å…³è”æ¸¸æˆ"
    gb_documents ||--o{ gb_document_tags : "æ ‡ç­¾"
    gb_documents }|--|| gb_categories : "æ‰€å±åˆ†ç±»"
    gb_documents }|--o| gb_storage_configs : "å­˜å‚¨é…ç½®"
    
    %% æ–‡ç« ç›¸å…³ï¼ˆAIç”Ÿæˆï¼‰
    gb_articles ||--o{ gb_article_generations : "ç”Ÿæˆè®°å½•"
    gb_articles ||--o{ gb_article_product_relations : "å…³è”äº§å“"
    gb_articles ||--o{ gb_article_resources : "èµ„æºé™„ä»¶"
    gb_articles }|--o| gb_prompt_templates : "ä½¿ç”¨æ¨¡æ¿"
    gb_articles }|--o| gb_storage_configs : "èµ„æºå­˜å‚¨é…ç½®"
    gb_article_generations }|--|| gb_ai_platforms : "ä½¿ç”¨å¹³å°"
    gb_article_generations }|--o| gb_prompt_templates : "ä½¿ç”¨æ¨¡æ¿"
    gb_article_resources }|--o| gb_storage_configs : "å­˜å‚¨ä½ç½®"
    
    %% æç¤ºè¯æ¨¡æ¿
    gb_prompt_templates ||--o{ gb_articles : "ç”Ÿæˆæ–‡ç« "
    gb_prompt_templates ||--o{ gb_article_generations : "ç”Ÿæˆè®°å½•"
    
    %% å­˜å‚¨è¿ç§»ç›¸å…³
    gb_storage_migration_rules ||--o{ gb_storage_migration_logs : "æ‰§è¡Œæ—¥å¿—"
    gb_article_resources ||--o{ gb_storage_migration_logs : "è¿ç§»è®°å½•"
    
    %% çŸ­å‰§ç›¸å…³
    gb_drama_vendors ||--o{ gb_dramas : "æ‹¥æœ‰"
    gb_dramas ||--o{ gb_article_product_relations : "è¢«æ–‡ç« å…³è”"
    
    %% æ¸¸æˆä¸æ–‡ç« å…³è”
    gb_games ||--o{ gb_document_game_relations : "è¢«æ–‡æ¡£å…³è”"
    gb_games ||--o{ gb_article_product_relations : "è¢«æ–‡ç« å…³è”"
    gb_game_boxes ||--o{ gb_article_product_relations : "è¢«æ–‡ç« å…³è”"
    
    %% ç»Ÿè®¡ç›¸å…³
    gb_documents ||--o{ gb_page_views : "æµè§ˆè®°å½•"
    gb_articles ||--o{ gb_page_views : "æµè§ˆè®°å½•"
    
    %% æœç´¢ç›¸å…³
    gb_search_logs ||--o{ gb_search_clicks : "ç‚¹å‡»è®°å½•"
```

### 1.4 æ¸¸æˆæ¨å¹¿æ•°æ®ç»“æ„å›¾

```mermaid
flowchart TB
    subgraph æ¸¸æˆç›’å­å±‚
        BOX[æ¸¸æˆç›’å­<br/>gb_game_boxes]
        BOX_QR[ç›’å­äºŒç»´ç ]
        BOX_LINK[æ¨å¹¿é“¾æ¥1234]
    end
    
    subgraph æ¸¸æˆå±‚
        GAME[æ¸¸æˆ<br/>gb_games]
        GAME --> |æŠ˜æ‰£ä¿¡æ¯| DISCOUNT[é¦–å……ç»­å……æŠ˜æ‰£<br/>å›½å†…æµ·å¤–]
        GAME --> |è®¾å¤‡æ”¯æŒ| DEVICE[å®‰å“iOSåŒç«¯]
    end
    
    subgraph æ¸¸æˆæ‰©å±•æ•°æ®
        GAME --> ACTIVITY[æ´»åŠ¨<br/>gb_game_activities]
        GAME --> SERVER[å¼€æœ<br/>gb_game_servers]
        GAME --> GIFTCODE[ç¤¼åŒ…<br/>gb_game_giftcodes]
        GAME --> MATERIAL[ç´ æ<br/>gb_game_materials]
    end
    
    subgraph å…³è”å±‚
        BOX <-->|gb_box_game_relations| GAME
        REL[ç›’å­æ¸¸æˆå…³è”]
        REL --> |ç‰¹å®šæŠ˜æ‰£| SPEC_DISCOUNT[ç›’å­å†…æ¸¸æˆæŠ˜æ‰£]
        REL --> |æ¨å¹¿é“¾æ¥| PROMO[ä¸‹è½½é“¾æ¥æ¨å¹¿ç½‘ç«™]
        REL --> |ç´ æ| POSTER[äºŒç»´ç æµ·æŠ¥æ¨å¹¿è¯­]
    end
    
    BOX --> BOX_QR
    BOX --> BOX_LINK
```

### 1.5 äº§å“ç±»å‹è¯´æ˜

æœ¬ç³»ç»Ÿæ”¯æŒå¤šç§äº§å“ç±»å‹çš„æ¨å¹¿ç®¡ç†ï¼š

| äº§å“ç±»å‹ | ç±»å‹æ ‡è¯† | è¯´æ˜ |
|---------|---------|------|
| æ¸¸æˆç›’å­ | `game_box` | åŒ…å«å¤šä¸ªæ¸¸æˆçš„èšåˆå¹³å° |
| æ¸¸æˆ | `game` | å•ä¸ªæ¸¸æˆäº§å“ |
| çŸ­å‰§å‚å•† | `drama_vendor` | çŸ­å‰§å‘è¡Œ/åˆ¶ä½œå¹³å° |
| çŸ­å‰§ | `drama` | å•ä¸ªçŸ­å‰§ä½œå“ |
| å…¶ä»–äº§å“ | `other` | é¢„ç•™æ‰©å±•ç±»å‹ |

---

## 2. å†…å®¹ä¸šåŠ¡åº“è¡¨è®¾è®¡

### 2.1 ç½‘ç«™è¡¨ (gb_sites)

ç®¡ç†å¤šä¸ªæ¨å¹¿ç½‘ç«™ï¼Œæ¯ä¸ªç½‘ç«™å¯ç‹¬ç«‹ç®¡ç†å…¶äº§å“å’Œå†…å®¹ã€‚

```sql
CREATE TABLE `gb_sites` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `name` varchar(100) NOT NULL COMMENT 'ç½‘ç«™åç§°',
  `domain` varchar(255) NOT NULL COMMENT 'ç½‘ç«™åŸŸå',
  `site_type` varchar(20) NOT NULL DEFAULT 'game' COMMENT 'ç½‘ç«™ç±»å‹ï¼šgame-æ¸¸æˆæ¨å¹¿ drama-çŸ­å‰§æ¨å¹¿ mixed-æ··åˆ',
  `logo_url` varchar(500) DEFAULT NULL COMMENT 'ç½‘ç«™Logo',
  `favicon_url` varchar(500) DEFAULT NULL COMMENT 'ç½‘ç«™Favicon',
  `description` text COMMENT 'ç½‘ç«™æè¿°',
  `seo_title` varchar(255) DEFAULT NULL COMMENT 'SEOæ ‡é¢˜',
  `seo_keywords` varchar(500) DEFAULT NULL COMMENT 'SEOå…³é”®è¯',
  `seo_description` varchar(500) DEFAULT NULL COMMENT 'SEOæè¿°',
  `config` json DEFAULT NULL COMMENT 'ç½‘ç«™é…ç½®ï¼ˆJSONï¼‰',
  `storage_config_id` bigint DEFAULT NULL COMMENT 'é»˜è®¤å­˜å‚¨é…ç½®ID',
  
  -- å¤šè¯­è¨€é…ç½®
  `default_locale` varchar(10) DEFAULT 'zh-CN' COMMENT 'é»˜è®¤è¯­è¨€',
  `supported_locales` json DEFAULT NULL COMMENT 'æ”¯æŒçš„è¯­è¨€åˆ—è¡¨ï¼ˆJSONæ•°ç»„ï¼‰',
  `i18n_mode` varchar(20) DEFAULT 'subdirectory' COMMENT 'å¤šè¯­è¨€æ¨¡å¼ï¼šsubdirectory-å­ç›®å½•(/en/) subdomain-å­åŸŸå(en.xxx.com) query-å‚æ•°(?lang=en)',
  
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_domain` (`domain`),
  KEY `idx_site_type` (`site_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç½‘ç«™è¡¨';
```

**å¤šè¯­è¨€æ¨¡å¼è¯´æ˜ï¼š**

| i18n_mode | è¯´æ˜ | URLç¤ºä¾‹ |
|-----------|------|---------|
| subdirectory | å­ç›®å½•æ¨¡å¼ | `https://example.com/en/article/xxx` |
| subdomain | å­åŸŸåæ¨¡å¼ | `https://en.example.com/article/xxx` |
| query | å‚æ•°æ¨¡å¼ | `https://example.com/article/xxx?lang=en` |

### 2.2 ç½‘ç«™è¯­è¨€é…ç½®è¡¨ (gb_site_locales)

ç®¡ç†ç½‘ç«™æ”¯æŒçš„è¯­è¨€åŠå…¶å­˜å‚¨ã€å‘å¸ƒè§„åˆ™é…ç½®ã€‚

```sql
CREATE TABLE `gb_site_locales` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint NOT NULL COMMENT 'ç½‘ç«™ID',
  `locale` varchar(10) NOT NULL COMMENT 'è¯­è¨€ä»£ç ï¼ˆå¦‚ zh-CN, en-US, ja-JPï¼‰',
  `locale_name` varchar(50) NOT NULL COMMENT 'è¯­è¨€åç§°ï¼ˆå¦‚ ç®€ä½“ä¸­æ–‡, Englishï¼‰',
  `native_name` varchar(50) DEFAULT NULL COMMENT 'è¯­è¨€æœ¬åœ°åç§°ï¼ˆå¦‚ ç®€ä½“ä¸­æ–‡, Englishï¼‰',
  `is_default` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦é»˜è®¤è¯­è¨€ï¼š0-å¦ 1-æ˜¯',
  `is_enabled` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦å¯ç”¨ï¼š0-å¦ 1-æ˜¯',
  
  -- å­˜å‚¨è§„åˆ™é…ç½®
  `storage_config_id` bigint DEFAULT NULL COMMENT 'è¯¥è¯­è¨€ä¸“ç”¨å­˜å‚¨é…ç½®IDï¼ˆNULLä½¿ç”¨ç½‘ç«™é»˜è®¤ï¼‰',
  `storage_path_template` varchar(500) DEFAULT '{locale}/{category}/{slug}' COMMENT 'å­˜å‚¨è·¯å¾„æ¨¡æ¿',
  
  -- å‘å¸ƒé“¾æ¥è§„åˆ™
  `url_prefix` varchar(100) DEFAULT NULL COMMENT 'URLå‰ç¼€ï¼ˆå¦‚ /en æˆ– en.ï¼‰',
  `url_template` varchar(500) DEFAULT '/{locale}/{category}/{slug}' COMMENT 'å‘å¸ƒURLæ¨¡æ¿',
  `domain_override` varchar(255) DEFAULT NULL COMMENT 'åŸŸåè¦†ç›–ï¼ˆç”¨äºå­åŸŸåæ¨¡å¼ï¼‰',
  
  -- SEOé…ç½®
  `seo_title_template` varchar(255) DEFAULT NULL COMMENT 'SEOæ ‡é¢˜æ¨¡æ¿',
  `seo_description_template` varchar(500) DEFAULT NULL COMMENT 'SEOæè¿°æ¨¡æ¿',
  
  -- AIç”Ÿæˆé…ç½®
  `ai_prompt_suffix` text COMMENT 'AIç”Ÿæˆæ—¶çš„è¯­è¨€æç¤ºè¯åç¼€',
  `translation_prompt` text COMMENT 'ç¿»è¯‘æç¤ºè¯æ¨¡æ¿',
  
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_locale` (`site_id`, `locale`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_is_enabled` (`is_enabled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='ç½‘ç«™è¯­è¨€é…ç½®è¡¨';
```

**å­˜å‚¨è·¯å¾„æ¨¡æ¿å˜é‡ï¼š**

| å˜é‡ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `{locale}` | è¯­è¨€ä»£ç  | `en-US` |
| `{locale_short}` | çŸ­è¯­è¨€ä»£ç  | `en` |
| `{category}` | åˆ†ç±»æ ‡è¯† | `strategy` |
| `{slug}` | æ–‡ç« æ ‡è¯† | `game-guide` |
| `{year}` | å¹´ä»½ | `2025` |
| `{month}` | æœˆä»½ | `12` |

**é…ç½®ç¤ºä¾‹ï¼š**

```json
{
  "site_id": 1,
  "locales": [
    {
      "locale": "zh-CN",
      "locale_name": "ç®€ä½“ä¸­æ–‡",
      "is_default": true,
      "storage_path_template": "zh-CN/{category}/{slug}",
      "url_template": "/{category}/{slug}"
    },
    {
      "locale": "en-US",
      "locale_name": "English",
      "is_default": false,
      "storage_path_template": "en-US/{category}/{slug}",
      "url_template": "/en/{category}/{slug}",
      "ai_prompt_suffix": "Please write the article in English."
    },
    {
      "locale": "ja-JP",
      "locale_name": "æ—¥æœ¬èª",
      "is_default": false,
      "storage_path_template": "ja-JP/{category}/{slug}",
      "url_template": "/ja/{category}/{slug}",
      "ai_prompt_suffix": "è¨˜äº‹ã‚’æ—¥æœ¬èªã§æ›¸ã„ã¦ãã ã•ã„ã€‚"
    }
  ]
}
```

### 2.3 å¯¹è±¡å­˜å‚¨é…ç½®è¡¨ (gb_storage_configs)

æ”¯æŒå¤šç§å¯¹è±¡å­˜å‚¨æ–¹å¼ï¼šGitHubä»“åº“ã€MinIOã€Cloudflare R2ç­‰ã€‚æ”¯æŒç«™ç‚¹çº§åˆ«çš„å­˜å‚¨é…ç½®ç®¡ç†ï¼Œå¯é…ç½®å¤šä¸ªå­˜å‚¨ç”¨äºè½®æ¢æˆ–å®¹é‡æ»¡ååˆ‡æ¢ã€‚

```sql
CREATE TABLE `gb_storage_configs` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™IDï¼ˆNULLè¡¨ç¤ºå…¨å±€é…ç½®ï¼‰',
  `name` varchar(100) NOT NULL COMMENT 'é…ç½®åç§°',
  `code` varchar(50) NOT NULL COMMENT 'é…ç½®ä»£ç ï¼ˆå”¯ä¸€æ ‡è¯†ï¼Œå¦‚ github-main, r2-backupï¼‰',
  `storage_type` varchar(20) NOT NULL COMMENT 'å­˜å‚¨ç±»å‹ï¼šgithub/minio/r2/oss/cos/s3',
  `storage_purpose` varchar(20) DEFAULT 'mixed' COMMENT 'å­˜å‚¨ç”¨é€”ï¼šarticle-æ–‡ç« å†…å®¹ resource-èµ„æºæ–‡ä»¶ mixed-æ··åˆ',
  `is_default` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦é»˜è®¤ï¼š0-å¦ 1-æ˜¯',
  `priority` int DEFAULT 100 COMMENT 'ä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼Œç”¨äºå­˜å‚¨è½®æ¢ï¼‰',
  
  -- GitHub ä»“åº“é…ç½®
  `github_owner` varchar(100) DEFAULT NULL COMMENT 'GitHub ç”¨æˆ·å/ç»„ç»‡å',
  `github_repo` varchar(100) DEFAULT NULL COMMENT 'GitHub ä»“åº“å',
  `github_branch` varchar(50) DEFAULT 'main' COMMENT 'GitHub åˆ†æ”¯',
  `github_token` varchar(255) DEFAULT NULL COMMENT 'GitHub Tokenï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `github_path_prefix` varchar(255) DEFAULT '' COMMENT 'GitHub è·¯å¾„å‰ç¼€',
  
  -- MinIO é…ç½®
  `minio_endpoint` varchar(255) DEFAULT NULL COMMENT 'MinIO æœåŠ¡åœ°å€',
  `minio_port` int DEFAULT 9000 COMMENT 'MinIO ç«¯å£',
  `minio_use_ssl` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ä½¿ç”¨SSL',
  `minio_access_key` varchar(255) DEFAULT NULL COMMENT 'MinIO Access Key',
  `minio_secret_key` varchar(255) DEFAULT NULL COMMENT 'MinIO Secret Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `minio_bucket` varchar(100) DEFAULT NULL COMMENT 'MinIO Bucketåç§°',
  `minio_region` varchar(50) DEFAULT NULL COMMENT 'MinIO Region',
  
  -- R2 / S3å…¼å®¹é…ç½®
  `r2_account_id` varchar(100) DEFAULT NULL COMMENT 'R2 Account ID',
  `r2_access_key` varchar(255) DEFAULT NULL COMMENT 'R2 Access Key',
  `r2_secret_key` varchar(255) DEFAULT NULL COMMENT 'R2 Secret Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `r2_bucket` varchar(100) DEFAULT NULL COMMENT 'R2 Bucketåç§°',
  `r2_public_url` varchar(500) DEFAULT NULL COMMENT 'R2 å…¬å¼€è®¿é—®URL',
  
  -- é˜¿é‡Œäº‘ OSS é…ç½®
  `oss_endpoint` varchar(255) DEFAULT NULL COMMENT 'OSS Endpoint',
  `oss_access_key` varchar(255) DEFAULT NULL COMMENT 'OSS Access Key',
  `oss_secret_key` varchar(255) DEFAULT NULL COMMENT 'OSS Secret Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `oss_bucket` varchar(100) DEFAULT NULL COMMENT 'OSS Bucketåç§°',
  `oss_region` varchar(50) DEFAULT NULL COMMENT 'OSS Region',
  
  -- è…¾è®¯äº‘ COS é…ç½®
  `cos_secret_id` varchar(255) DEFAULT NULL COMMENT 'COS Secret ID',
  `cos_secret_key` varchar(255) DEFAULT NULL COMMENT 'COS Secret Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `cos_bucket` varchar(100) DEFAULT NULL COMMENT 'COS Bucketåç§°',
  `cos_region` varchar(50) DEFAULT NULL COMMENT 'COS Region',
  
  -- é€šç”¨é…ç½®
  `cdn_url` varchar(500) DEFAULT NULL COMMENT 'CDNåŠ é€Ÿåœ°å€',
  `custom_domain` varchar(255) DEFAULT NULL COMMENT 'è‡ªå®šä¹‰è®¿é—®åŸŸå',
  `base_path` varchar(255) DEFAULT '' COMMENT 'åŸºç¡€è·¯å¾„å‰ç¼€',
  `max_file_size` bigint DEFAULT 10485760 COMMENT 'æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œé»˜è®¤10MB',
  `allowed_extensions` varchar(500) DEFAULT 'md,json,txt,jpg,png,gif,webp,mp4,webm' COMMENT 'å…è®¸çš„æ–‡ä»¶æ‰©å±•å',
  
  -- å®¹é‡ç®¡ç†
  `capacity_limit` bigint DEFAULT NULL COMMENT 'å®¹é‡ä¸Šé™ï¼ˆå­—èŠ‚ï¼ŒNULLè¡¨ç¤ºä¸é™åˆ¶ï¼‰',
  `used_capacity` bigint DEFAULT 0 COMMENT 'å·²ä½¿ç”¨å®¹é‡ï¼ˆå­—èŠ‚ï¼‰',
  `file_count` int DEFAULT 0 COMMENT 'æ–‡ä»¶æ•°é‡',
  `file_count_limit` int DEFAULT NULL COMMENT 'æ–‡ä»¶æ•°é‡ä¸Šé™ï¼ˆNULLè¡¨ç¤ºä¸é™åˆ¶ï¼‰',
  `capacity_warning_threshold` decimal(5,2) DEFAULT 80.00 COMMENT 'å®¹é‡é¢„è­¦é˜ˆå€¼ï¼ˆç™¾åˆ†æ¯”ï¼‰',
  `is_capacity_full` tinyint DEFAULT 0 COMMENT 'å®¹é‡æ˜¯å¦å·²æ»¡ï¼š0-å¦ 1-æ˜¯',
  `capacity_full_at` datetime DEFAULT NULL COMMENT 'å®¹é‡æ»¡æ—¶é—´',
  
  -- è½®æ¢é…ç½®
  `fallback_storage_id` bigint DEFAULT NULL COMMENT 'å¤‡ç”¨å­˜å‚¨é…ç½®IDï¼ˆå½“å‰å­˜å‚¨æ»¡åä½¿ç”¨ï¼‰',
  `auto_switch_on_full` tinyint DEFAULT 1 COMMENT 'å®¹é‡æ»¡æ—¶æ˜¯å¦è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡ç”¨å­˜å‚¨ï¼š0-å¦ 1-æ˜¯',
  
  -- å¥åº·æ£€æŸ¥
  `last_health_check` datetime DEFAULT NULL COMMENT 'æœ€åå¥åº·æ£€æŸ¥æ—¶é—´',
  `health_status` varchar(20) DEFAULT 'unknown' COMMENT 'å¥åº·çŠ¶æ€ï¼šunknown/healthy/degraded/unhealthy',
  `health_message` varchar(500) DEFAULT NULL COMMENT 'å¥åº·çŠ¶æ€ä¿¡æ¯',
  
  `description` text COMMENT 'é…ç½®æè¿°',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_code` (`code`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_storage_type` (`storage_type`),
  KEY `idx_storage_purpose` (`storage_purpose`),
  KEY `idx_is_default` (`is_default`),
  KEY `idx_priority` (`priority`),
  KEY `idx_is_capacity_full` (`is_capacity_full`),
  KEY `idx_health_status` (`health_status`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¯¹è±¡å­˜å‚¨é…ç½®è¡¨';
```

**å­˜å‚¨é…ç½®ç¤ºä¾‹ï¼š**

| å­˜å‚¨ç±»å‹ | è®¿é—®åœ°å€ç¤ºä¾‹ | è¯´æ˜ |
|---------|-------------|------|
| GitHub | `https://raw.githubusercontent.com/{owner}/{repo}/{branch}/{path}` | é€‚åˆæ–‡æ¡£ç±»é™æ€å†…å®¹ |
| MinIO | `http://{endpoint}:{port}/{bucket}/{path}` | è‡ªå»ºå¯¹è±¡å­˜å‚¨ |
| R2 | `https://{custom_domain}/{path}` | Cloudflareè¾¹ç¼˜å­˜å‚¨ |
| OSS | `https://{bucket}.{region}.aliyuncs.com/{path}` | é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ |
| COS | `https://{bucket}.cos.{region}.myqcloud.com/{path}` | è…¾è®¯äº‘å¯¹è±¡å­˜å‚¨ |

**å­˜å‚¨è½®æ¢ç­–ç•¥ï¼š**

```mermaid
flowchart TB
    subgraph å­˜å‚¨é…ç½®
        S1[ä¸»å­˜å‚¨<br/>priority: 10]
        S2[å¤‡ç”¨å­˜å‚¨1<br/>priority: 20]
        S3[å¤‡ç”¨å­˜å‚¨2<br/>priority: 30]
    end
    
    subgraph å®¹é‡æ£€æŸ¥
        CHECK{å®¹é‡æ£€æŸ¥}
        FULL1{ä¸»å­˜å‚¨æ»¡?}
        FULL2{å¤‡ç”¨1æ»¡?}
    end
    
    NEW[æ–°æ–‡ç« /èµ„æº] --> CHECK
    CHECK --> FULL1
    FULL1 -->|å¦| S1
    FULL1 -->|æ˜¯| FULL2
    FULL2 -->|å¦| S2
    FULL2 -->|æ˜¯| S3
```

**å­˜å‚¨ç”¨é€”è¯´æ˜ï¼š**

| storage_purpose | è¯´æ˜ | å…¸å‹åœºæ™¯ |
|-----------------|------|---------|
| article | æ–‡ç« å†…å®¹å­˜å‚¨ | Markdownæ–‡ä»¶ã€HTMLæ–‡ä»¶ |
| resource | èµ„æºæ–‡ä»¶å­˜å‚¨ | å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ |
| mixed | æ··åˆå­˜å‚¨ | åŒæ—¶å­˜å‚¨æ–‡ç« å’Œèµ„æº |

### 2.3 æ–‡æ¡£è¡¨ (gb_documents)

å­˜å‚¨ Markdown æ–‡æ¡£çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œæ”¯æŒæŒ‰å‘å¸ƒæ—¥æœŸåˆ†ç±»ã€‚

```sql
CREATE TABLE `gb_documents` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `slug` varchar(255) NOT NULL COMMENT 'æ–‡æ¡£è·¯å¾„æ ‡è¯†ï¼ˆå”¯ä¸€ï¼‰',
  `title` varchar(255) NOT NULL COMMENT 'æ–‡æ¡£æ ‡é¢˜',
  `category_id` bigint DEFAULT NULL COMMENT 'åˆ†ç±»ID',
  `subcategory` varchar(100) DEFAULT NULL COMMENT 'å­åˆ†ç±»',
  `keywords` varchar(500) DEFAULT NULL COMMENT 'å…³é”®è¯ï¼Œé€—å·åˆ†éš”',
  `description` text COMMENT 'æ–‡æ¡£æè¿°/æ‘˜è¦',
  `content_preview` text COMMENT 'å†…å®¹é¢„è§ˆï¼ˆå‰500å­—ï¼‰',
  
  -- å­˜å‚¨ä¿¡æ¯
  `storage_config_id` bigint DEFAULT NULL COMMENT 'å­˜å‚¨é…ç½®ID',
  `storage_key` varchar(500) NOT NULL COMMENT 'å­˜å‚¨é”®/è·¯å¾„',
  `storage_url` varchar(1000) DEFAULT NULL COMMENT 'å®Œæ•´è®¿é—®URL',
  
  -- æ–‡æ¡£ç»Ÿè®¡
  `file_size` int DEFAULT 0 COMMENT 'æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰',
  `reading_time` int DEFAULT 0 COMMENT 'é¢„ä¼°é˜…è¯»æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
  `word_count` int DEFAULT 0 COMMENT 'å­—æ•°ç»Ÿè®¡',
  `view_count` int DEFAULT 0 COMMENT 'æµè§ˆæ¬¡æ•°',
  `like_count` int DEFAULT 0 COMMENT 'ç‚¹èµæ¬¡æ•°',
  
  -- å‘å¸ƒæ—¥æœŸåˆ†ç±»
  `publish_year` int DEFAULT NULL COMMENT 'å‘å¸ƒå¹´ä»½',
  `publish_month` int DEFAULT NULL COMMENT 'å‘å¸ƒæœˆä»½',
  `publish_day` int DEFAULT NULL COMMENT 'å‘å¸ƒæ—¥æœŸ',
  
  `is_published` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦å‘å¸ƒï¼š0-å¦ 1-æ˜¯',
  `is_indexed` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦å·²ç´¢å¼•åˆ°ESï¼š0-å¦ 1-æ˜¯',
  `published_at` datetime DEFAULT NULL COMMENT 'å‘å¸ƒæ—¶é—´',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `deleted_at` datetime DEFAULT NULL COMMENT 'åˆ é™¤æ—¶é—´ï¼ˆè½¯åˆ é™¤ï¼‰',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_slug` (`slug`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_category` (`category_id`),
  KEY `idx_storage_config` (`storage_config_id`),
  KEY `idx_published_at` (`published_at`),
  KEY `idx_publish_date` (`publish_year`, `publish_month`, `publish_day`),
  KEY `idx_is_published` (`is_published`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡æ¡£è¡¨';
```

### 2.4 åˆ†ç±»è¡¨ (gb_categories)

```sql
CREATE TABLE `gb_categories` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `parent_id` bigint DEFAULT 0 COMMENT 'çˆ¶åˆ†ç±»IDï¼Œ0ä¸ºé¡¶çº§',
  `category_type` varchar(20) DEFAULT 'game' COMMENT 'åˆ†ç±»ç±»å‹ï¼šgame-æ¸¸æˆ drama-çŸ­å‰§ article-æ–‡ç« ',
  `name` varchar(50) NOT NULL COMMENT 'åˆ†ç±»åç§°',
  `slug` varchar(50) NOT NULL COMMENT 'åˆ†ç±»æ ‡è¯†',
  `icon` varchar(100) DEFAULT NULL COMMENT 'åˆ†ç±»å›¾æ ‡',
  `description` varchar(255) DEFAULT NULL COMMENT 'åˆ†ç±»æè¿°',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åºåºå·',
  `document_count` int DEFAULT 0 COMMENT 'æ–‡æ¡£æ•°é‡',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_slug` (`site_id`, `slug`),
  KEY `idx_parent_id` (`parent_id`),
  KEY `idx_category_type` (`category_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='åˆ†ç±»è¡¨';
```

### 2.5 æ¸¸æˆè¡¨ (gb_games)

å­˜å‚¨æ¸¸æˆè¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æŠ˜æ‰£ã€è®¾å¤‡æ”¯æŒã€ä¸Šæ¶æ—¶é—´ç­‰ã€‚

```sql
CREATE TABLE `gb_games` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `name` varchar(100) NOT NULL COMMENT 'æ¸¸æˆåç§°',
  `subtitle` varchar(200) DEFAULT NULL COMMENT 'æ¸¸æˆå‰¯æ ‡é¢˜/ç‰ˆæœ¬è¯´æ˜ï¼ˆå¦‚ï¼š0.1æŠ˜éƒ½å¸‚æ‰“é‡‘ï¼‰',
  `short_name` varchar(50) DEFAULT NULL COMMENT 'æ¸¸æˆç®€ç§°',
  `category` varchar(50) DEFAULT NULL COMMENT 'æ¸¸æˆåˆ†ç±»ï¼ˆä»™ä¾ ã€ä¼ å¥‡ç­‰ï¼‰',
  `game_type` varchar(20) DEFAULT 'official' COMMENT 'æ¸¸æˆç±»å‹ï¼šofficial-å®˜æ–¹ discount-æŠ˜æ‰£ bt-BTç‰ˆ coming-å³å°†ä¸Šçº¿',
  `icon_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆå›¾æ ‡URL',
  `cover_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆå°é¢URL',
  `screenshots` json DEFAULT NULL COMMENT 'æ¸¸æˆæˆªå›¾ï¼ˆJSONæ•°ç»„ï¼‰',
  `video_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆè§†é¢‘URL',
  `description` text COMMENT 'æ¸¸æˆæè¿°',
  `promotion_desc` text COMMENT 'æ¨å¹¿è¯´æ˜',
  `developer` varchar(100) DEFAULT NULL COMMENT 'å¼€å‘å•†',
  `publisher` varchar(100) DEFAULT NULL COMMENT 'å‘è¡Œå•†',
  `package_name` varchar(200) DEFAULT NULL COMMENT 'åŒ…å',
  `version` varchar(50) DEFAULT NULL COMMENT 'ç‰ˆæœ¬å·',
  `size` varchar(50) DEFAULT NULL COMMENT 'å®‰è£…åŒ…å¤§å°',
  
  -- ä¸‹è½½ç›¸å…³
  `download_url` varchar(500) DEFAULT NULL COMMENT 'é€šç”¨ä¸‹è½½é“¾æ¥',
  `android_url` varchar(500) DEFAULT NULL COMMENT 'å®‰å“ä¸‹è½½é“¾æ¥',
  `ios_url` varchar(500) DEFAULT NULL COMMENT 'iOSä¸‹è½½é“¾æ¥',
  `apk_url` varchar(500) DEFAULT NULL COMMENT 'APKç›´æ¥ä¸‹è½½',
  
  -- è®¾å¤‡æ”¯æŒ
  `device_support` varchar(20) DEFAULT 'both' COMMENT 'è®¾å¤‡æ”¯æŒï¼šandroid-å®‰å“ ios-iOS both-åŒç«¯',
  
  -- æŠ˜æ‰£ä¿¡æ¯
  `discount_label` varchar(20) DEFAULT NULL COMMENT 'æŠ˜æ‰£æ ‡ç­¾ï¼ˆ0.1æŠ˜ã€BTç­‰ï¼‰',
  `first_charge_domestic` decimal(4,2) DEFAULT NULL COMMENT 'é¦–å……æŠ˜æ‰£-å›½å†…',
  `first_charge_overseas` decimal(4,2) DEFAULT NULL COMMENT 'é¦–å……æŠ˜æ‰£-æµ·å¤–',
  `recharge_domestic` decimal(4,2) DEFAULT NULL COMMENT 'ç»­å……æŠ˜æ‰£-å›½å†…',
  `recharge_overseas` decimal(4,2) DEFAULT NULL COMMENT 'ç»­å……æŠ˜æ‰£-æµ·å¤–',
  
  -- æ‰¶æŒä¸ç¦åˆ©
  `has_support` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æœ‰æ‰¶æŒï¼š0-æ—  1-æœ‰',
  `support_desc` text COMMENT 'æ‰¶æŒè¯´æ˜',
  `has_low_deduct_coupon` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æœ‰ä½æ‰£åˆ¸é¢†å–ï¼š0-æ—  1-æœ‰',
  `low_deduct_coupon_url` varchar(500) DEFAULT NULL COMMENT 'ä½æ‰£åˆ¸é¢†å–é“¾æ¥',
  
  -- ç»Ÿè®¡
  `download_count` int DEFAULT 0 COMMENT 'ä¸‹è½½æ¬¡æ•°',
  `rating` decimal(2,1) DEFAULT 0.0 COMMENT 'è¯„åˆ†ï¼ˆ0-5ï¼‰',
  `features` json DEFAULT NULL COMMENT 'æ¸¸æˆç‰¹æ€§ï¼ˆJSONæ•°ç»„ï¼‰',
  `tags` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾ï¼Œé€—å·åˆ†éš”',
  
  -- ä¸Šæ¶ä¿¡æ¯
  `launch_time` datetime DEFAULT NULL COMMENT 'ä¸Šæ¶/å¼€æœæ—¶é—´',
  `is_new` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ–°æ¸¸ï¼š0-å¦ 1-æ˜¯',
  `is_hot` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦çƒ­é—¨ï¼š0-å¦ 1-æ˜¯',
  `is_recommend` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ¨èï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ä¸‹æ¶ 1-ä¸Šæ¶',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_name` (`name`),
  KEY `idx_category` (`category`),
  KEY `idx_game_type` (`game_type`),
  KEY `idx_device_support` (`device_support`),
  KEY `idx_launch_time` (`launch_time`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆè¡¨';
```

**æ¸¸æˆç±»å‹ä¸æŠ˜æ‰£è¯´æ˜ï¼š**

| game_type | è¯´æ˜ | å…¸å‹æŠ˜æ‰£ |
|-----------|------|---------|
| official | å®˜æ–¹æ­£ç‰ˆæ¸¸æˆ | æ— æŠ˜æ‰£æˆ–å°‘é‡æŠ˜æ‰£ |
| discount | æŠ˜æ‰£æ¸¸æˆ | 0.1æŠ˜ã€1æŠ˜ç­‰ |
| bt | BTç‰ˆ/å˜æ€ç‰ˆ | é«˜ç¦åˆ©ã€é«˜è¿”åˆ© |
| coming | å³å°†ä¸Šçº¿ | é¢„çº¦ä¸­ |

**è®¾å¤‡æ”¯æŒè¯´æ˜ï¼š**

| device_support | è¯´æ˜ | å›¾æ ‡ |
|----------------|------|------|
| android | ä»…å®‰å“ | ğŸ“± |
| ios | ä»…iOS | ğŸ |
| both | åŒç«¯äº’é€š | ğŸ“±ğŸ |

### 2.6 æ¸¸æˆç›’å­è¡¨ (gb_game_boxes)

å­˜å‚¨æ¸¸æˆç›’å­ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¤šä¸ªæ¨å¹¿é“¾æ¥ã€äºŒç»´ç ç­‰ã€‚

```sql
CREATE TABLE `gb_game_boxes` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `name` varchar(100) NOT NULL COMMENT 'ç›’å­åç§°',
  `logo_url` varchar(500) DEFAULT NULL COMMENT 'ç›’å­Logo',
  `banner_url` varchar(500) DEFAULT NULL COMMENT 'ç›’å­Bannerå›¾',
  `qrcode_url` varchar(500) DEFAULT NULL COMMENT 'ç›’å­äºŒç»´ç å›¾ç‰‡URL',
  `description` text COMMENT 'ç›’å­æè¿°',
  
  -- å®˜æ–¹é“¾æ¥
  `official_url` varchar(500) DEFAULT NULL COMMENT 'å®˜ç½‘åœ°å€',
  `download_url` varchar(500) DEFAULT NULL COMMENT 'é€šç”¨ä¸‹è½½åœ°å€',
  `android_url` varchar(500) DEFAULT NULL COMMENT 'å®‰å“ä¸‹è½½',
  `ios_url` varchar(500) DEFAULT NULL COMMENT 'iOSä¸‹è½½',
  
  -- æ¨å¹¿é“¾æ¥ï¼ˆæ”¯æŒå¤šä¸ªï¼‰
  `promote_url_1` varchar(500) DEFAULT NULL COMMENT 'æ¨å¹¿é“¾æ¥â‘ ',
  `promote_url_2` varchar(500) DEFAULT NULL COMMENT 'æ¨å¹¿é“¾æ¥â‘¡',
  `promote_url_3` varchar(500) DEFAULT NULL COMMENT 'æ¨å¹¿é“¾æ¥â‘¢',
  `register_download_url` varchar(500) DEFAULT NULL COMMENT 'å…ˆæ³¨å†Œå†ä¸‹è½½é“¾æ¥â‘£',
  
  -- æŠ˜æ‰£ä¿¡æ¯
  `discount_rate` decimal(3,2) DEFAULT 1.00 COMMENT 'æŠ˜æ‰£ç‡ï¼ˆ0.1-1.0ï¼‰',
  `features` json DEFAULT NULL COMMENT 'ç‰¹è‰²åŠŸèƒ½ï¼ˆJSONæ•°ç»„ï¼‰',
  `game_count` int DEFAULT 0 COMMENT 'æ”¶å½•æ¸¸æˆæ•°',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ä¸‹æ¶ 1-ä¸Šæ¶',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_name` (`name`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆç›’å­è¡¨';
```

**æ¨å¹¿é“¾æ¥è¯´æ˜ï¼ˆæ¥è‡ªæˆªå›¾ç¤ºä¾‹ï¼‰ï¼š**

| é“¾æ¥ç±»å‹ | ç¤ºä¾‹æ ¼å¼ | ç”¨é€” |
|---------|---------|------|
| æ¨å¹¿é“¾æ¥â‘  | `https://www.u2game99.com/app/1037.html` | æ ‡å‡†æ¨å¹¿é¡µ |
| æ¨å¹¿é“¾æ¥â‘¡ | `https://www.u2game99.com/a/1037.html` | å¤‡ç”¨æ¨å¹¿é¡µ |
| æ¨å¹¿é“¾æ¥â‘¢ | `https://www.u2game99.com/b/1037.html` | å¤‡ç”¨æ¨å¹¿é¡µ |
| å…ˆæ³¨å†Œå†ä¸‹è½½â‘£ | `https://qdzs.u2game99.com/welcome/page/ag/1037.html` | å¼•å¯¼æ³¨å†Œé¡µ |

### 2.7 æ¸¸æˆç›’å­-æ¸¸æˆå…³è”è¡¨ (gb_box_game_relations)

æ¸¸æˆç›’å­ä¸æ¸¸æˆçš„å¤šå¯¹å¤šå…³ç³»è¡¨ï¼ŒåŒ…å«æ¯ä¸ªç›’å­ä¸­æ¸¸æˆçš„ç‰¹å®šæ¨å¹¿ä¿¡æ¯ã€‚

```sql
CREATE TABLE `gb_box_game_relations` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `box_id` bigint NOT NULL COMMENT 'æ¸¸æˆç›’å­ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  
  -- æ¸¸æˆåœ¨è¯¥ç›’å­ä¸­çš„æŠ˜æ‰£ä¿¡æ¯
  `discount_label` varchar(20) DEFAULT NULL COMMENT 'æŠ˜æ‰£æ ‡ç­¾ï¼ˆ0.1æŠ˜ã€BTç­‰ï¼‰',
  `first_charge_domestic` decimal(4,2) DEFAULT NULL COMMENT 'é¦–å……æŠ˜æ‰£-å›½å†…',
  `first_charge_overseas` decimal(4,2) DEFAULT NULL COMMENT 'é¦–å……æŠ˜æ‰£-æµ·å¤–',
  `recharge_domestic` decimal(4,2) DEFAULT NULL COMMENT 'ç»­å……æŠ˜æ‰£-å›½å†…',
  `recharge_overseas` decimal(4,2) DEFAULT NULL COMMENT 'ç»­å……æŠ˜æ‰£-æµ·å¤–',
  
  -- æ‰¶æŒä¿¡æ¯
  `has_support` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æœ‰æ‰¶æŒï¼š0-æ—  1-æœ‰',
  `support_desc` text COMMENT 'æ‰¶æŒè¯´æ˜',
  
  -- æ¨å¹¿é“¾æ¥
  `download_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆä¸‹è½½é“¾æ¥ï¼ˆå¸¦è¿½è¸ªå‚æ•°ï¼‰',
  `promote_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆæ¨å¹¿ç½‘ç«™é“¾æ¥',
  `qrcode_url` varchar(500) DEFAULT NULL COMMENT 'æ¸¸æˆäºŒç»´ç URL',
  `promote_text` text COMMENT 'æ¨å¹¿è¯­',
  `poster_url` varchar(500) DEFAULT NULL COMMENT 'å®£ä¼ å¡ç‰‡/æµ·æŠ¥URL',
  
  `is_featured` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ¨èï¼š0-å¦ 1-æ˜¯',
  `is_exclusive` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ç‹¬å ï¼š0-å¦ 1-æ˜¯',
  `is_new` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ–°æ¸¸ï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `added_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'æ·»åŠ æ—¶é—´',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_box_game` (`box_id`, `game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_is_featured` (`is_featured`),
  KEY `idx_is_new` (`is_new`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆç›’å­-æ¸¸æˆå…³è”è¡¨';
```

**æ¨å¹¿é“¾æ¥ç¤ºä¾‹ï¼ˆæ¥è‡ªæˆªå›¾ï¼‰ï¼š**

| é“¾æ¥ç±»å‹ | ç¤ºä¾‹æ ¼å¼ | è¯´æ˜ |
|---------|---------|------|
| ä¸‹è½½é“¾æ¥ | `https://qd.u2game99.com/down.html?ag=GMS123&gid=1693` | å¸¦æ¨å¹¿å‘˜IDå’Œæ¸¸æˆID |
| æ¨å¹¿ç½‘ç«™ | `https://www.u2game99.com/wg/1037/1693.html` | ç›’å­ID/æ¸¸æˆID |

**å…³è”å…³ç³»è¯´æ˜ï¼š**

```mermaid
flowchart LR
    subgraph æ¸¸æˆç›’å­
        BOX1[3733æ¸¸æˆç›’]
        BOX2[7723æ¸¸æˆç›’]
        BOX3[996æ‰‹æ¸¸ç›’å­]
    end
    
    subgraph æ¸¸æˆ
        GAME1[æ–©å¦–å½•]
        GAME2[ä¸‰å›½å¿—æˆ˜ç•¥ç‰ˆ]
        GAME3[åŸç¥]
    end
    
    BOX1 ---|0.5æŠ˜| GAME1
    BOX1 ---|0.6æŠ˜| GAME2
    BOX2 ---|0.4æŠ˜| GAME1
    BOX2 ---|0.5æŠ˜| GAME3
    BOX3 ---|0.3æŠ˜| GAME1
    BOX3 ---|0.5æŠ˜| GAME2
    BOX3 ---|0.6æŠ˜| GAME3
```

### 2.8 æ¸¸æˆæ´»åŠ¨è¡¨ (gb_game_activities)

å­˜å‚¨æ¸¸æˆçš„æ´»åŠ¨ä¿¡æ¯ã€‚

```sql
CREATE TABLE `gb_game_activities` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  `box_id` bigint DEFAULT NULL COMMENT 'æ¸¸æˆç›’å­IDï¼ˆå¯é€‰ï¼Œç›’å­ç‰¹æœ‰æ´»åŠ¨ï¼‰',
  `name` varchar(100) NOT NULL COMMENT 'æ´»åŠ¨åç§°',
  `activity_type` varchar(20) DEFAULT 'activity' COMMENT 'ç±»å‹ï¼šactivity-æ´»åŠ¨ server-å¼€æœ other-å…¶ä»–',
  `description` text COMMENT 'æ´»åŠ¨æè¿°',
  `banner_url` varchar(500) DEFAULT NULL COMMENT 'æ´»åŠ¨Banner',
  `start_time` datetime NOT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `end_time` datetime NOT NULL COMMENT 'ç»“æŸæ—¶é—´',
  `is_permanent` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ°¸ä¹…ï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_activity_type` (`activity_type`),
  KEY `idx_time_range` (`start_time`, `end_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆæ´»åŠ¨è¡¨';
```

### 2.9 æ¸¸æˆå¼€æœè¡¨ (gb_game_servers)

å­˜å‚¨æ¸¸æˆå¼€æœä¿¡æ¯ã€‚

```sql
CREATE TABLE `gb_game_servers` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  `box_id` bigint DEFAULT NULL COMMENT 'æ¸¸æˆç›’å­ID',
  `server_name` varchar(100) NOT NULL COMMENT 'æœåŠ¡å™¨åç§°',
  `server_no` varchar(50) DEFAULT NULL COMMENT 'æœåŠ¡å™¨ç¼–å·',
  `open_time` datetime NOT NULL COMMENT 'å¼€æœæ—¶é—´',
  `server_type` varchar(20) DEFAULT 'new' COMMENT 'ç±»å‹ï¼šnew-æ–°æœ merge-åˆæœ test-æµ‹è¯•æœ',
  `description` text COMMENT 'å¼€æœè¯´æ˜',
  `is_recommend` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ¨èï¼š0-å¦ 1-æ˜¯',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-å·²å…³é—­ 1-æ­£å¸¸ 2-ç«çˆ†',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_open_time` (`open_time`),
  KEY `idx_server_type` (`server_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆå¼€æœè¡¨';
```

### 2.10 æ¸¸æˆç¤¼åŒ…è¡¨ (gb_game_giftcodes)

å­˜å‚¨æ¸¸æˆç¤¼åŒ…ä¿¡æ¯ï¼Œæ”¯æŒå¤šç§ç¤¼åŒ…ç±»å‹ã€‚

```sql
CREATE TABLE `gb_game_giftcodes` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  `box_id` bigint DEFAULT NULL COMMENT 'æ¸¸æˆç›’å­ID',
  `name` varchar(100) NOT NULL COMMENT 'ç¤¼åŒ…åç§°ï¼ˆæ–°æ‰‹ç¤¼åŒ…ã€é¢„çº¦ç¤¼åŒ…ç­‰ï¼‰',
  `gift_type` varchar(20) DEFAULT 'newbie' COMMENT 'ç¤¼åŒ…ç±»å‹ï¼šnewbie-æ–°æ‰‹å¡ reserve-é¢„çº¦ community-ç¤¾åŒº welfare-ç¦åˆ©',
  `content` text COMMENT 'ç¤¼åŒ…å†…å®¹è¯´æ˜',
  `items` json DEFAULT NULL COMMENT 'ç¤¼åŒ…ç‰©å“ï¼ˆJSONæ•°ç»„ï¼‰',
  `code` varchar(100) DEFAULT NULL COMMENT 'ç¤¼åŒ…ç ï¼ˆé€šç”¨ç ï¼‰',
  `total_count` int DEFAULT 9999 COMMENT 'æ€»æ•°é‡',
  `remain_count` int DEFAULT 9999 COMMENT 'å‰©ä½™æ•°é‡',
  `limit_per_user` int DEFAULT 1 COMMENT 'æ¯äººé™é¢†',
  `start_time` datetime DEFAULT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `end_time` datetime DEFAULT NULL COMMENT 'ç»“æŸæ—¶é—´',
  `is_exclusive` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ç‹¬å ï¼ˆä»…è¯¥ç›’å­å¯é¢†ï¼‰ï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_gift_type` (`gift_type`),
  KEY `idx_time_range` (`start_time`, `end_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆç¤¼åŒ…è¡¨';
```

**ç¤¼åŒ…ç±»å‹è¯´æ˜ï¼ˆæ¥è‡ªæˆªå›¾ï¼‰ï¼š**

| gift_type | åç§° | å…¸å‹å†…å®¹ |
|-----------|------|---------|
| newbie | æ–°æ‰‹ç¤¼åŒ… | ç»‘é‡‘*5000000, å¯»å®é’¥åŒ™*50, ç¿…è†€è¿›é˜¶ä¸¹*10 |
| reserve | é¢„çº¦ç¤¼åŒ… | ç»‘é‡‘*5000000, å¯»å®é’¥åŒ™*60, è§‰é†’è¿›é˜¶ä¸¹*10 |
| community | ç¤¾åŒºç¤¼åŒ… | ç»‘é‡‘*5000000, å¯»å®é’¥åŒ™*60, èƒŒé¥°ç¢ç‰‡*3000 |
| welfare | ç¦åˆ©ç¤¼åŒ… | ç»‘é‡‘*5000000, å¯»å®é’¥åŒ™*60, æŠ¤ç›¾ç¢ç‰‡*3000 |

### 2.11 æ¸¸æˆç´ æè¡¨ (gb_game_materials)

å­˜å‚¨æ¸¸æˆæ¨å¹¿ç´ æï¼ˆå›¾ç‰‡ã€è§†é¢‘ç­‰ï¼‰ã€‚

```sql
CREATE TABLE `gb_game_materials` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  `box_id` bigint DEFAULT NULL COMMENT 'æ¸¸æˆç›’å­ID',
  `material_type` varchar(20) NOT NULL COMMENT 'ç´ æç±»å‹ï¼šicon-å›¾æ ‡ cover-å°é¢ screenshot-æˆªå›¾ video-è§†é¢‘ poster-æµ·æŠ¥ qrcode-äºŒç»´ç ',
  `name` varchar(100) DEFAULT NULL COMMENT 'ç´ æåç§°',
  `url` varchar(500) NOT NULL COMMENT 'ç´ æURL',
  `thumbnail_url` varchar(500) DEFAULT NULL COMMENT 'ç¼©ç•¥å›¾URL',
  `file_size` int DEFAULT 0 COMMENT 'æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰',
  `width` int DEFAULT 0 COMMENT 'å®½åº¦ï¼ˆåƒç´ ï¼‰',
  `height` int DEFAULT 0 COMMENT 'é«˜åº¦ï¼ˆåƒç´ ï¼‰',
  `duration` int DEFAULT 0 COMMENT 'æ—¶é•¿ï¼ˆç§’ï¼Œè§†é¢‘ç”¨ï¼‰',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_material_type` (`material_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¸¸æˆç´ æè¡¨';
```

### 2.12 æ–‡æ¡£-æ¸¸æˆå…³è”è¡¨ (gb_document_game_relations)

```sql
CREATE TABLE `gb_document_game_relations` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `document_id` bigint NOT NULL COMMENT 'æ–‡æ¡£ID',
  `game_id` bigint NOT NULL COMMENT 'æ¸¸æˆID',
  `box_id` bigint DEFAULT NULL COMMENT 'å…³è”çš„æ¸¸æˆç›’å­IDï¼ˆå¯é€‰ï¼‰',
  `relation_type` varchar(20) DEFAULT 'auto' COMMENT 'å…³è”ç±»å‹ï¼šauto-è‡ªåŠ¨ manual-æ‰‹åŠ¨',
  `relevance_score` decimal(5,4) DEFAULT 0.0000 COMMENT 'ç›¸å…³åº¦è¯„åˆ†ï¼ˆ0-1ï¼‰',
  `is_primary` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ä¸»å…³è”ï¼š0-å¦ 1-æ˜¯',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_document_game` (`document_id`, `game_id`),
  KEY `idx_document_id` (`document_id`),
  KEY `idx_game_id` (`game_id`),
  KEY `idx_box_id` (`box_id`),
  KEY `idx_relevance` (`relevance_score` DESC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡æ¡£-æ¸¸æˆå…³è”è¡¨';
```

### 2.13 æ ‡ç­¾è¡¨ (gb_tags)

```sql
CREATE TABLE `gb_tags` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `tag_type` varchar(20) DEFAULT 'general' COMMENT 'æ ‡ç­¾ç±»å‹ï¼šgeneral-é€šç”¨ game-æ¸¸æˆ drama-çŸ­å‰§',
  `name` varchar(50) NOT NULL COMMENT 'æ ‡ç­¾åç§°',
  `slug` varchar(50) NOT NULL COMMENT 'æ ‡ç­¾æ ‡è¯†',
  `color` varchar(20) DEFAULT NULL COMMENT 'æ ‡ç­¾é¢œè‰²',
  `use_count` int DEFAULT 0 COMMENT 'ä½¿ç”¨æ¬¡æ•°',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_name` (`site_id`, `name`),
  KEY `idx_tag_type` (`tag_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ ‡ç­¾è¡¨';
```

### 2.14 æ–‡æ¡£-æ ‡ç­¾å…³è”è¡¨ (gb_document_tags)

```sql
CREATE TABLE `gb_document_tags` (
  `document_id` bigint NOT NULL COMMENT 'æ–‡æ¡£ID',
  `tag_id` bigint NOT NULL COMMENT 'æ ‡ç­¾ID',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`document_id`, `tag_id`),
  KEY `idx_tag_id` (`tag_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡æ¡£-æ ‡ç­¾å…³è”è¡¨';
```

---

## 3. çŸ­å‰§ç®¡ç†è¡¨è®¾è®¡

### 3.1 çŸ­å‰§å‚å•†è¡¨ (gb_drama_vendors)

```sql
CREATE TABLE `gb_drama_vendors` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `name` varchar(100) NOT NULL COMMENT 'å‚å•†åç§°',
  `short_name` varchar(50) DEFAULT NULL COMMENT 'å‚å•†ç®€ç§°',
  `logo_url` varchar(500) DEFAULT NULL COMMENT 'å‚å•†Logo',
  `banner_url` varchar(500) DEFAULT NULL COMMENT 'å‚å•†Bannerå›¾',
  `description` text COMMENT 'å‚å•†æè¿°',
  `official_url` varchar(500) DEFAULT NULL COMMENT 'å®˜ç½‘åœ°å€',
  `app_download_url` varchar(500) DEFAULT NULL COMMENT 'APPä¸‹è½½åœ°å€',
  `android_url` varchar(500) DEFAULT NULL COMMENT 'å®‰å“ä¸‹è½½',
  `ios_url` varchar(500) DEFAULT NULL COMMENT 'iOSä¸‹è½½',
  `wechat_mini_appid` varchar(100) DEFAULT NULL COMMENT 'å¾®ä¿¡å°ç¨‹åºAppID',
  `contact_info` json DEFAULT NULL COMMENT 'è”ç³»æ–¹å¼ï¼ˆJSONï¼‰',
  `cooperation_type` varchar(50) DEFAULT NULL COMMENT 'åˆä½œç±»å‹ï¼šcps/cpa/cpm',
  `commission_rate` decimal(5,4) DEFAULT 0.0000 COMMENT 'ä½£é‡‘æ¯”ä¾‹',
  `features` json DEFAULT NULL COMMENT 'ç‰¹è‰²åŠŸèƒ½ï¼ˆJSONæ•°ç»„ï¼‰',
  `drama_count` int DEFAULT 0 COMMENT 'æ”¶å½•çŸ­å‰§æ•°',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ä¸‹æ¶ 1-ä¸Šæ¶',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_name` (`name`),
  KEY `idx_cooperation_type` (`cooperation_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='çŸ­å‰§å‚å•†è¡¨';
```

### 3.2 çŸ­å‰§è¡¨ (gb_dramas)

```sql
CREATE TABLE `gb_dramas` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `vendor_id` bigint DEFAULT NULL COMMENT 'æ‰€å±å‚å•†ID',
  `name` varchar(200) NOT NULL COMMENT 'çŸ­å‰§åç§°',
  `alias_name` varchar(200) DEFAULT NULL COMMENT 'åˆ«å',
  `cover_url` varchar(500) DEFAULT NULL COMMENT 'å°é¢å›¾URL',
  `poster_url` varchar(500) DEFAULT NULL COMMENT 'æµ·æŠ¥å›¾URL',
  `screenshots` json DEFAULT NULL COMMENT 'å‰§ç…§ï¼ˆJSONæ•°ç»„ï¼‰',
  `description` text COMMENT 'å‰§æƒ…ç®€ä»‹',
  `category` varchar(50) DEFAULT NULL COMMENT 'å‰§æƒ…åˆ†ç±»ï¼ˆç”œå® ã€é€†è¢­ã€è™æ‹ç­‰ï¼‰',
  `genre` varchar(100) DEFAULT NULL COMMENT 'é¢˜ææ ‡ç­¾',
  `director` varchar(100) DEFAULT NULL COMMENT 'å¯¼æ¼”',
  `actors` json DEFAULT NULL COMMENT 'ä¸»æ¼”ï¼ˆJSONæ•°ç»„ï¼‰',
  `episode_count` int DEFAULT 0 COMMENT 'æ€»é›†æ•°',
  `episode_duration` int DEFAULT 0 COMMENT 'æ¯é›†æ—¶é•¿ï¼ˆç§’ï¼‰',
  `total_duration` int DEFAULT 0 COMMENT 'æ€»æ—¶é•¿ï¼ˆç§’ï¼‰',
  `release_date` date DEFAULT NULL COMMENT 'ä¸Šçº¿æ—¥æœŸ',
  `source_platform` varchar(50) DEFAULT NULL COMMENT 'é¦–å‘å¹³å°',
  `play_url` varchar(500) DEFAULT NULL COMMENT 'æ’­æ”¾é“¾æ¥',
  `play_count` bigint DEFAULT 0 COMMENT 'æ’­æ”¾æ¬¡æ•°',
  `like_count` int DEFAULT 0 COMMENT 'ç‚¹èµæ¬¡æ•°',
  `collect_count` int DEFAULT 0 COMMENT 'æ”¶è—æ¬¡æ•°',
  `rating` decimal(2,1) DEFAULT 0.0 COMMENT 'è¯„åˆ†ï¼ˆ0-10ï¼‰',
  `is_free` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦å…è´¹ï¼š0-å¦ 1-æ˜¯',
  `price` decimal(10,2) DEFAULT 0.00 COMMENT 'ä»·æ ¼ï¼ˆå¦‚éœ€ä»˜è´¹ï¼‰',
  `tags` varchar(255) DEFAULT NULL COMMENT 'æ ‡ç­¾ï¼Œé€—å·åˆ†éš”',
  `is_hot` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦çƒ­é—¨ï¼š0-å¦ 1-æ˜¯',
  `is_new` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ–°å‰§ï¼š0-å¦ 1-æ˜¯',
  `is_recommend` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ¨èï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ä¸‹æ¶ 1-ä¸Šæ¶',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_vendor_id` (`vendor_id`),
  KEY `idx_name` (`name`),
  KEY `idx_category` (`category`),
  KEY `idx_release_date` (`release_date`),
  KEY `idx_is_hot` (`is_hot`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='çŸ­å‰§è¡¨';
```

**çŸ­å‰§åˆ†ç±»è¯´æ˜ï¼š**

| åˆ†ç±» | è¯´æ˜ | å…¸å‹æ ‡ç­¾ |
|-----|------|---------|
| ç”œå®  | ç”œèœœå® çˆ±ç±»å‰§æƒ… | éœ¸é“æ€»è£ã€ç°å§‘å¨˜é€†è¢­ |
| è™æ‹ | è™å¿ƒæ‹çˆ±ç±»å‰§æƒ… | å¤ä»‡ã€è¯¯ä¼šã€é‡ç”Ÿ |
| é€†è¢­ | å±Œä¸é€†è¢­ç±»å‰§æƒ… | èµ˜å©¿ã€æˆ˜ç¥ã€é¦–å¯Œ |
| ç©¿è¶Š | ç©¿è¶Šé‡ç”Ÿç±»å‰§æƒ… | å¤ç©¿ä»Šã€ä»Šç©¿å¤ã€å¼‚ä¸–ç•Œ |
| æ‚¬ç–‘ | æ‚¬ç–‘æ¨ç†ç±»å‰§æƒ… | ç ´æ¡ˆã€çƒ§è„‘ã€åè½¬ |
| å¤è£… | å¤è£…å†å²ç±»å‰§æƒ… | å®«æ–—ã€æƒè°‹ã€æ­¦ä¾  |

---

## 4. æ–‡ç« ç®¡ç†è¡¨è®¾è®¡ï¼ˆAIç”Ÿæˆæ”¯æŒï¼‰

### 4.1 æç¤ºè¯æ¨¡æ¿è¡¨ (gb_prompt_templates)

ç®¡ç†æ–‡ç« ç”Ÿæˆæ—¶ä½¿ç”¨çš„å„ç§æç¤ºè¯æ¨¡æ¿ã€‚

```sql
CREATE TABLE `gb_prompt_templates` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™IDï¼ˆNULLè¡¨ç¤ºå…¨å±€æ¨¡æ¿ï¼‰',
  `name` varchar(100) NOT NULL COMMENT 'æ¨¡æ¿åç§°',
  `template_code` varchar(50) NOT NULL COMMENT 'æ¨¡æ¿ä»£ç ï¼ˆå”¯ä¸€æ ‡è¯†ï¼‰',
  `template_type` varchar(30) NOT NULL COMMENT 'æ¨¡æ¿ç±»å‹ï¼šgame_intro-æ¸¸æˆä»‹ç» game_guide-æ¸¸æˆæ”»ç•¥ game_review-æ¸¸æˆè¯„æµ‹ drama_intro-çŸ­å‰§ä»‹ç» seo_article-SEOæ–‡ç«  custom-è‡ªå®šä¹‰',
  `description` varchar(500) DEFAULT NULL COMMENT 'æ¨¡æ¿æè¿°',
  
  -- æç¤ºè¯å†…å®¹
  `system_prompt` text COMMENT 'ç³»ç»Ÿæç¤ºè¯',
  `user_prompt_template` text NOT NULL COMMENT 'ç”¨æˆ·æç¤ºè¯æ¨¡æ¿ï¼ˆæ”¯æŒå˜é‡å ä½ç¬¦ï¼‰',
  `output_format` text COMMENT 'è¾“å‡ºæ ¼å¼è¯´æ˜',
  `example_output` text COMMENT 'ç¤ºä¾‹è¾“å‡º',
  
  -- å˜é‡é…ç½®
  `variables` json DEFAULT NULL COMMENT 'æ¨¡æ¿å˜é‡å®šä¹‰ï¼ˆJSONæ•°ç»„ï¼‰',
  `default_values` json DEFAULT NULL COMMENT 'å˜é‡é»˜è®¤å€¼ï¼ˆJSONå¯¹è±¡ï¼‰',
  
  -- ç”Ÿæˆå‚æ•°
  `ai_platform_id` bigint DEFAULT NULL COMMENT 'æ¨èAIå¹³å°ID',
  `model_name` varchar(100) DEFAULT NULL COMMENT 'æ¨èæ¨¡å‹',
  `temperature` decimal(3,2) DEFAULT 0.70 COMMENT 'æ¨èæ¸©åº¦',
  `max_tokens` int DEFAULT 4096 COMMENT 'æ¨èæœ€å¤§Tokenæ•°',
  
  -- ä½¿ç”¨ç»Ÿè®¡
  `use_count` int DEFAULT 0 COMMENT 'ä½¿ç”¨æ¬¡æ•°',
  `success_count` int DEFAULT 0 COMMENT 'æˆåŠŸæ¬¡æ•°',
  `avg_quality_score` decimal(3,2) DEFAULT NULL COMMENT 'å¹³å‡è´¨é‡è¯„åˆ†',
  
  `is_public` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦å…¬å¼€ï¼š0-ç§æœ‰ 1-å…¬å¼€',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_template_code` (`template_code`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_template_type` (`template_type`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æç¤ºè¯æ¨¡æ¿è¡¨';
```

**æ¨¡æ¿å˜é‡ç¤ºä¾‹ï¼š**

```json
{
  "variables": [
    {"name": "game_name", "type": "string", "required": true, "description": "æ¸¸æˆåç§°"},
    {"name": "game_category", "type": "string", "required": false, "description": "æ¸¸æˆåˆ†ç±»"},
    {"name": "keywords", "type": "array", "required": false, "description": "SEOå…³é”®è¯"},
    {"name": "word_count", "type": "number", "required": false, "default": 1000, "description": "ç›®æ ‡å­—æ•°"}
  ],
  "default_values": {
    "word_count": 1000,
    "tone": "ä¸“ä¸š"
  }
}
```

**æç¤ºè¯æ¨¡æ¿ç±»å‹è¯´æ˜ï¼š**

| template_type | è¯´æ˜ | å…¸å‹åœºæ™¯ |
|---------------|------|---------|
| game_intro | æ¸¸æˆä»‹ç» | æ–°æ¸¸æ¨èã€æ¸¸æˆä¸‹è½½é¡µä»‹ç» |
| game_guide | æ¸¸æˆæ”»ç•¥ | æ–°æ‰‹æ”»ç•¥ã€è¿›é˜¶æ”»ç•¥ |
| game_review | æ¸¸æˆè¯„æµ‹ | æ¸¸æˆæµ‹è¯„ã€å¯¹æ¯”åˆ†æ |
| drama_intro | çŸ­å‰§ä»‹ç» | çŸ­å‰§æ¨èã€å‰§æƒ…ç®€ä»‹ |
| seo_article | SEOæ–‡ç«  | é•¿å°¾è¯æ–‡ç« ã€å¼•æµæ–‡ç«  |
| custom | è‡ªå®šä¹‰ | ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿ |

### 4.2 AIå¹³å°é…ç½®è¡¨ (gb_ai_platforms)

```sql
CREATE TABLE `gb_ai_platforms` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `name` varchar(100) NOT NULL COMMENT 'å¹³å°åç§°',
  `platform_code` varchar(50) NOT NULL COMMENT 'å¹³å°ä»£ç ï¼šopenai/claude/gemini/qwen/doubao/wenxin/spark',
  `api_endpoint` varchar(500) NOT NULL COMMENT 'APIåœ°å€',
  `api_key` varchar(500) DEFAULT NULL COMMENT 'API Keyï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `api_secret` varchar(500) DEFAULT NULL COMMENT 'API Secretï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `model_name` varchar(100) DEFAULT NULL COMMENT 'é»˜è®¤æ¨¡å‹åç§°',
  `available_models` json DEFAULT NULL COMMENT 'å¯ç”¨æ¨¡å‹åˆ—è¡¨ï¼ˆJSONæ•°ç»„ï¼‰',
  `config` json DEFAULT NULL COMMENT 'å¹³å°é…ç½®ï¼ˆJSONï¼‰',
  `max_tokens` int DEFAULT 4096 COMMENT 'æœ€å¤§Tokenæ•°',
  `temperature` decimal(3,2) DEFAULT 0.70 COMMENT 'åˆ›ä½œæ¸©åº¦',
  `rate_limit` int DEFAULT 60 COMMENT 'é€Ÿç‡é™åˆ¶ï¼ˆè¯·æ±‚/åˆ†é’Ÿï¼‰',
  `cost_per_1k_tokens` decimal(10,6) DEFAULT 0.000000 COMMENT 'æ¯1000 Tokenæˆæœ¬',
  `is_default` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦é»˜è®¤ï¼š0-å¦ 1-æ˜¯',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_platform_code` (`platform_code`),
  KEY `idx_is_default` (`is_default`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIå¹³å°é…ç½®è¡¨';
```

**æ”¯æŒçš„AIå¹³å°ï¼š**

| å¹³å°ä»£ç  | å¹³å°åç§° | ä¸»è¦æ¨¡å‹ |
|---------|---------|---------|
| openai | OpenAI | GPT-4o, GPT-4-turbo |
| claude | Anthropic Claude | Claude 3.5 Sonnet |
| gemini | Google Gemini | Gemini Pro, Gemini Ultra |
| qwen | é˜¿é‡Œé€šä¹‰åƒé—® | Qwen-Max, Qwen-Plus |
| doubao | å­—èŠ‚è±†åŒ… | Doubao-Pro |
| wenxin | ç™¾åº¦æ–‡å¿ƒä¸€è¨€ | ERNIE-4.0 |
| spark | è®¯é£æ˜Ÿç« | Spark 4.0 |
| deepseek | DeepSeek | DeepSeek-V3 |

### 4.3 æ–‡ç« è¡¨ (gb_articles)

```sql
CREATE TABLE `gb_articles` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint NOT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `slug` varchar(255) NOT NULL COMMENT 'æ–‡ç« è·¯å¾„æ ‡è¯†',
  `locale` varchar(10) NOT NULL DEFAULT 'zh-CN' COMMENT 'æ–‡ç« è¯­è¨€',
  `master_article_id` bigint DEFAULT NULL COMMENT 'ä¸»æ–‡ç« IDï¼ˆå¤šè¯­è¨€ç‰ˆæœ¬å…³è”ï¼‰',
  `title` varchar(255) NOT NULL COMMENT 'æ–‡ç« æ ‡é¢˜',
  `subtitle` varchar(255) DEFAULT NULL COMMENT 'å‰¯æ ‡é¢˜',
  `category_id` bigint DEFAULT NULL COMMENT 'åˆ†ç±»ID',
  `author` varchar(100) DEFAULT NULL COMMENT 'ä½œè€…',
  `keywords` varchar(500) DEFAULT NULL COMMENT 'å…³é”®è¯ï¼Œé€—å·åˆ†éš”',
  `description` text COMMENT 'æ–‡ç« æ‘˜è¦',
  `content` longtext COMMENT 'æ–‡ç« å†…å®¹ï¼ˆMarkdown/HTMLï¼‰',
  `content_type` varchar(20) DEFAULT 'markdown' COMMENT 'å†…å®¹ç±»å‹ï¼šmarkdown/html',
  `cover_url` varchar(500) DEFAULT NULL COMMENT 'å°é¢å›¾URL',
  
  -- æ–‡ç« å†…å®¹å­˜å‚¨ï¼ˆæ–‡ç« æœ¬èº«çš„å­˜å‚¨ä½ç½®ï¼‰
  `storage_config_id` bigint DEFAULT NULL COMMENT 'æ–‡ç« å†…å®¹å­˜å‚¨é…ç½®ID',
  `storage_key` varchar(500) DEFAULT NULL COMMENT 'å­˜å‚¨é”®/è·¯å¾„',
  `storage_url` varchar(1000) DEFAULT NULL COMMENT 'å®Œæ•´è®¿é—®URL',
  
  -- æ–‡ç« èµ„æºå­˜å‚¨ï¼ˆæ–‡ç« ä¸­å›¾ç‰‡/è§†é¢‘çš„å­˜å‚¨ä½ç½®ï¼Œç‹¬ç«‹äºæ–‡ç« å†…å®¹ï¼‰
  `resource_storage_config_id` bigint DEFAULT NULL COMMENT 'èµ„æºå­˜å‚¨é…ç½®IDï¼ˆå›¾ç‰‡/è§†é¢‘ï¼‰',
  `resource_base_path` varchar(500) DEFAULT NULL COMMENT 'èµ„æºåŸºç¡€è·¯å¾„',
  
  -- AIç”Ÿæˆä¿¡æ¯
  `is_ai_generated` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦AIç”Ÿæˆï¼š0-å¦ 1-æ˜¯',
  `is_ai_translated` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦AIç¿»è¯‘ï¼š0-å¦ 1-æ˜¯',
  `prompt_template_id` bigint DEFAULT NULL COMMENT 'ä½¿ç”¨çš„æç¤ºè¯æ¨¡æ¿ID',
  `generation_count` int DEFAULT 0 COMMENT 'ç”Ÿæˆæ¬¡æ•°',
  `last_generation_id` bigint DEFAULT NULL COMMENT 'æœ€åä¸€æ¬¡ç”Ÿæˆè®°å½•ID',
  
  -- å‘å¸ƒæ—¥æœŸåˆ†ç±»
  `publish_year` int DEFAULT NULL COMMENT 'å‘å¸ƒå¹´ä»½',
  `publish_month` int DEFAULT NULL COMMENT 'å‘å¸ƒæœˆä»½',
  `publish_day` int DEFAULT NULL COMMENT 'å‘å¸ƒæ—¥æœŸ',
  
  -- ç»Ÿè®¡ä¿¡æ¯
  `word_count` int DEFAULT 0 COMMENT 'å­—æ•°ç»Ÿè®¡',
  `reading_time` int DEFAULT 0 COMMENT 'é¢„ä¼°é˜…è¯»æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰',
  `resource_count` int DEFAULT 0 COMMENT 'èµ„æºæ•°é‡ï¼ˆå›¾ç‰‡+è§†é¢‘ï¼‰',
  `view_count` int DEFAULT 0 COMMENT 'æµè§ˆæ¬¡æ•°',
  `like_count` int DEFAULT 0 COMMENT 'ç‚¹èµæ¬¡æ•°',
  `comment_count` int DEFAULT 0 COMMENT 'è¯„è®ºæ¬¡æ•°',
  `share_count` int DEFAULT 0 COMMENT 'åˆ†äº«æ¬¡æ•°',
  
  `is_published` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦å‘å¸ƒï¼š0-å¦ 1-æ˜¯',
  `is_top` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ç½®é¡¶ï¼š0-å¦ 1-æ˜¯',
  `is_recommend` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ¨èï¼š0-å¦ 1-æ˜¯',
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `published_at` datetime DEFAULT NULL COMMENT 'å‘å¸ƒæ—¶é—´',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `deleted_at` datetime DEFAULT NULL COMMENT 'åˆ é™¤æ—¶é—´ï¼ˆè½¯åˆ é™¤ï¼‰',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_locale_slug` (`site_id`, `locale`, `slug`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_locale` (`locale`),
  KEY `idx_master_article` (`master_article_id`),
  KEY `idx_category_id` (`category_id`),
  KEY `idx_storage_config` (`storage_config_id`),
  KEY `idx_resource_storage` (`resource_storage_config_id`),
  KEY `idx_prompt_template` (`prompt_template_id`),
  KEY `idx_publish_date` (`publish_year`, `publish_month`, `publish_day`),
  KEY `idx_is_published` (`is_published`),
  KEY `idx_is_ai_generated` (`is_ai_generated`),
  KEY `idx_published_at` (`published_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡ç« è¡¨';
```

**å¤šè¯­è¨€æ–‡ç« å…³ç³»è¯´æ˜ï¼š**

```mermaid
flowchart LR
    subgraph MasterArticle[ä¸»æ–‡ç« -ä¸­æ–‡]
        A1[æ–‡ç« ID: 1<br/>locale: zh-CN<br/>master_article_id: NULL]
    end
    
    subgraph Translations[ç¿»è¯‘ç‰ˆæœ¬]
        A2[æ–‡ç« ID: 2<br/>locale: en-US<br/>master_article_id: 1]
        A3[æ–‡ç« ID: 3<br/>locale: ja-JP<br/>master_article_id: 1]
    end
    
    A1 -->|ç¿»è¯‘| A2
    A1 -->|ç¿»è¯‘| A3
```

### 4.4 AI ç”Ÿæˆæ‰¹é‡ä»»åŠ¡è¡¨ (gb_ai_batch_tasks)

è®°å½•æ‰¹é‡ç”Ÿæˆä»»åŠ¡ï¼Œæ”¯æŒå®šæ—¶è°ƒåº¦å’Œè¿›åº¦ç›‘æ§ã€‚é€šè¿‡ GitHub Action æ‰§è¡Œã€‚

```sql
CREATE TABLE `gb_ai_batch_tasks` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint NOT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `task_name` varchar(100) NOT NULL COMMENT 'ä»»åŠ¡åç§°',
  `task_type` varchar(20) DEFAULT 'batch' COMMENT 'ä»»åŠ¡ç±»å‹ï¼šsingle-å•ç¯‡ batch-æ‰¹é‡',
  
  -- æ‰¹é‡é…ç½®
  `batch_config` json NOT NULL COMMENT 'æ‰¹é‡é…ç½®JSONï¼ˆåŒ…å«tasksæ•°ç»„å’Œoptionsï¼‰',
  `total_count` int DEFAULT 0 COMMENT 'ä»»åŠ¡æ€»æ•°',
  
  -- å¤šè¯­è¨€é…ç½®
  `target_locales` json DEFAULT NULL COMMENT 'ç›®æ ‡è¯­è¨€åˆ—è¡¨ï¼ˆJSONæ•°ç»„ï¼Œå¦‚ ["zh-CN", "en-US", "ja-JP"]ï¼‰',
  `locale_generation_mode` varchar(20) DEFAULT 'primary_only' COMMENT 'å¤šè¯­è¨€ç”Ÿæˆæ¨¡å¼ï¼šprimary_only-ä»…ä¸»è¯­è¨€ translate-ç¿»è¯‘ç”Ÿæˆ parallel-å¹¶è¡Œç”Ÿæˆ',
  
  -- è°ƒåº¦é…ç½®
  `schedule_type` varchar(20) DEFAULT 'manual' COMMENT 'è°ƒåº¦ç±»å‹ï¼šmanual-æ‰‹åŠ¨ once-å•æ¬¡å®šæ—¶ cron-å®šæ—¶å¾ªç¯',
  `cron_expression` varchar(50) DEFAULT NULL COMMENT 'Cronè¡¨è¾¾å¼',
  `next_execution_time` datetime DEFAULT NULL COMMENT 'ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´',
  `last_execution_time` datetime DEFAULT NULL COMMENT 'ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´',
  
  -- GitHub é›†æˆ
  `github_repo_id` bigint DEFAULT NULL COMMENT 'GitHubä»“åº“é…ç½®ID',
  `workflow_file` varchar(100) DEFAULT 'ai-generate-articles.yml' COMMENT 'å·¥ä½œæµæ–‡ä»¶å',
  
  -- æ‰§è¡ŒçŠ¶æ€
  `status` tinyint DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0-å¾…æ‰§è¡Œ 1-æ‰§è¡Œä¸­ 2-å·²å®Œæˆ 3-éƒ¨åˆ†å¤±è´¥ 4-å…¨éƒ¨å¤±è´¥ 5-å·²å–æ¶ˆ',
  `is_enabled` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦å¯ç”¨ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_by` bigint DEFAULT NULL COMMENT 'æ›´æ–°äºº',
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_task_type` (`task_type`),
  KEY `idx_schedule_type` (`schedule_type`),
  KEY `idx_status` (`status`),
  KEY `idx_is_enabled` (`is_enabled`),
  KEY `idx_next_execution` (`next_execution_time`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIç”Ÿæˆæ‰¹é‡ä»»åŠ¡è¡¨';
```

### 4.5 AI ä»»åŠ¡æ‰§è¡Œè®°å½•è¡¨ (gb_ai_task_executions)

è®°å½•æ¯æ¬¡ä»»åŠ¡æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯ï¼Œå…³è” GitHub Workflow Runã€‚

```sql
CREATE TABLE `gb_ai_task_executions` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `batch_task_id` bigint NOT NULL COMMENT 'æ‰¹é‡ä»»åŠ¡ID',
  `execution_no` varchar(50) NOT NULL COMMENT 'æ‰§è¡Œç¼–å·ï¼ˆç”¨äºå…³è”å›è°ƒï¼‰',
  
  -- GitHub Workflow ä¿¡æ¯
  `workflow_run_id` bigint DEFAULT NULL COMMENT 'GitHub Workflow Run ID',
  `workflow_run_url` varchar(500) DEFAULT NULL COMMENT 'Workflow Run URL',
  `workflow_status` varchar(20) DEFAULT NULL COMMENT 'WorkflowçŠ¶æ€ï¼šqueued/in_progress/completed',
  `workflow_conclusion` varchar(20) DEFAULT NULL COMMENT 'Workflowç»“è®ºï¼šsuccess/failure/cancelled',
  
  -- æ‰§è¡Œç»Ÿè®¡
  `total_articles` int DEFAULT 0 COMMENT 'æ€»æ–‡ç« æ•°',
  `completed_articles` int DEFAULT 0 COMMENT 'å·²å®Œæˆæ•°',
  `failed_articles` int DEFAULT 0 COMMENT 'å¤±è´¥æ•°',
  `total_tokens` int DEFAULT 0 COMMENT 'æ€»æ¶ˆè€—Token',
  `total_images` int DEFAULT 0 COMMENT 'å¤„ç†å›¾ç‰‡æ•°',
  
  -- æ—¶é—´ä¿¡æ¯
  `started_at` datetime DEFAULT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `completed_at` datetime DEFAULT NULL COMMENT 'å®Œæˆæ—¶é—´',
  `execution_duration` int DEFAULT NULL COMMENT 'æ‰§è¡Œæ—¶é•¿ï¼ˆç§’ï¼‰',
  
  -- çŠ¶æ€
  `status` tinyint DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0-åˆå§‹åŒ– 1-å·²è§¦å‘ 2-æ‰§è¡Œä¸­ 3-å·²å®Œæˆ 4-å¤±è´¥ 5-å·²å–æ¶ˆ',
  `error_message` text COMMENT 'é”™è¯¯ä¿¡æ¯',
  
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_execution_no` (`execution_no`),
  KEY `idx_batch_task_id` (`batch_task_id`),
  KEY `idx_workflow_run_id` (`workflow_run_id`),
  KEY `idx_status` (`status`),
  KEY `idx_started_at` (`started_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIä»»åŠ¡æ‰§è¡Œè®°å½•è¡¨';
```

### 4.6 AI ä»»åŠ¡æ‰§è¡Œè¯¦æƒ…è¡¨ (gb_ai_task_execution_items)

è®°å½•æ‰¹é‡ä»»åŠ¡ä¸­æ¯ç¯‡æ–‡ç« çš„æ‰§è¡ŒçŠ¶æ€ã€‚

```sql
CREATE TABLE `gb_ai_task_execution_items` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `execution_id` bigint NOT NULL COMMENT 'æ‰§è¡Œè®°å½•ID',
  `item_index` int NOT NULL COMMENT 'ä»»åŠ¡åºå·',
  
  -- ä»»åŠ¡é…ç½®
  `game_name` varchar(100) NOT NULL COMMENT 'æ¸¸æˆåç§°',
  `category` varchar(50) DEFAULT NULL COMMENT 'åˆ†ç±»',
  `template` varchar(50) DEFAULT NULL COMMENT 'æ¨¡æ¿',
  `locale` varchar(10) NOT NULL DEFAULT 'zh-CN' COMMENT 'ç›®æ ‡è¯­è¨€',
  `ai_provider` varchar(20) DEFAULT NULL COMMENT 'AIå¹³å°',
  `custom_prompt` text COMMENT 'è‡ªå®šä¹‰æç¤ºè¯',
  
  -- ç¿»è¯‘ç›¸å…³
  `source_article_id` bigint DEFAULT NULL COMMENT 'æºæ–‡ç« IDï¼ˆç¿»è¯‘æ¨¡å¼æ—¶ä½¿ç”¨ï¼‰',
  `is_translation` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ä¸ºç¿»è¯‘ä»»åŠ¡ï¼š0-å¦ 1-æ˜¯',
  
  -- æ‰§è¡Œç»“æœ
  `article_id` bigint DEFAULT NULL COMMENT 'ç”Ÿæˆçš„æ–‡ç« ID',
  `generated_file_path` varchar(500) DEFAULT NULL COMMENT 'ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„',
  `tokens_used` int DEFAULT 0 COMMENT 'æ¶ˆè€—Tokenæ•°',
  `images_processed` int DEFAULT 0 COMMENT 'å¤„ç†å›¾ç‰‡æ•°',
  `execution_time_ms` int DEFAULT 0 COMMENT 'æ‰§è¡Œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰',
  
  -- çŠ¶æ€
  `status` tinyint DEFAULT 0 COMMENT 'çŠ¶æ€ï¼š0-å¾…æ‰§è¡Œ 1-æ‰§è¡Œä¸­ 2-æˆåŠŸ 3-å¤±è´¥ 4-è·³è¿‡',
  `error_message` text COMMENT 'é”™è¯¯ä¿¡æ¯',
  `started_at` datetime DEFAULT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `completed_at` datetime DEFAULT NULL COMMENT 'å®Œæˆæ—¶é—´',
  
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_execution_id` (`execution_id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_locale` (`locale`),
  KEY `idx_source_article` (`source_article_id`),
  KEY `idx_status` (`status`),
  KEY `idx_game_name` (`game_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIä»»åŠ¡æ‰§è¡Œè¯¦æƒ…è¡¨';
```

### 4.7 GitHub ä»“åº“é…ç½®è¡¨ (gb_github_repos)

å­˜å‚¨ç”¨æˆ·è¿æ¥çš„ GitHub ä»“åº“ä¿¡æ¯ã€‚

```sql
CREATE TABLE `gb_github_repos` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™IDï¼ˆNULLè¡¨ç¤ºå…¨å±€é…ç½®ï¼‰',
  `user_id` bigint NOT NULL COMMENT 'ç”¨æˆ·ID',
  `repo_type` varchar(20) NOT NULL COMMENT 'ä»“åº“ç±»å‹ï¼šcontent-å†…å®¹ä»“åº“ generator-ç”Ÿæˆå™¨ä»“åº“',
  
  -- ä»“åº“ä¿¡æ¯
  `owner` varchar(100) NOT NULL COMMENT 'ä»“åº“æ‰€æœ‰è€…',
  `repo_name` varchar(100) NOT NULL COMMENT 'ä»“åº“åç§°',
  `full_name` varchar(200) NOT NULL COMMENT 'å®Œæ•´åç§°ï¼ˆowner/repoï¼‰',
  `default_branch` varchar(50) DEFAULT 'main' COMMENT 'é»˜è®¤åˆ†æ”¯',
  `is_fork` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ä¸ºForkä»“åº“',
  `source_repo` varchar(200) DEFAULT NULL COMMENT 'æºä»“åº“ï¼ˆForkæ¥æºï¼‰',
  
  -- è®¤è¯ä¿¡æ¯
  `access_token` varchar(500) DEFAULT NULL COMMENT 'Access Tokenï¼ˆåŠ å¯†å­˜å‚¨ï¼‰',
  `token_expires_at` datetime DEFAULT NULL COMMENT 'Tokenè¿‡æœŸæ—¶é—´',
  
  -- çŠ¶æ€
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-æ–­å¼€ 1-å·²è¿æ¥ 2-Tokenè¿‡æœŸ',
  `last_sync_at` datetime DEFAULT NULL COMMENT 'æœ€ååŒæ­¥æ—¶é—´',
  `sync_error` text COMMENT 'åŒæ­¥é”™è¯¯ä¿¡æ¯',
  
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_user_repo` (`site_id`, `user_id`, `repo_type`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_user_id` (`user_id`),
  KEY `idx_repo_type` (`repo_type`),
  KEY `idx_full_name` (`full_name`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='GitHubä»“åº“é…ç½®è¡¨';
```

### 4.8 æ–‡ç« ç”Ÿæˆè®°å½•è¡¨ (gb_article_generations)

è®°å½•æ¯æ¬¡AIç”Ÿæˆçš„è¯¦ç»†ä¿¡æ¯ï¼Œæ”¯æŒå¤šæ¬¡ç”Ÿæˆå’Œå›æº¯ï¼Œå…³è”ä½¿ç”¨çš„æç¤ºè¯æ¨¡æ¿ã€‚

```sql
CREATE TABLE `gb_article_generations` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `article_id` bigint NOT NULL COMMENT 'æ–‡ç« ID',
  `ai_platform_id` bigint NOT NULL COMMENT 'AIå¹³å°ID',
  `prompt_template_id` bigint DEFAULT NULL COMMENT 'ä½¿ç”¨çš„æç¤ºè¯æ¨¡æ¿ID',
  `model_name` varchar(100) NOT NULL COMMENT 'ä½¿ç”¨çš„æ¨¡å‹åç§°',
  `generation_version` int DEFAULT 1 COMMENT 'ç”Ÿæˆç‰ˆæœ¬å·',
  
  -- æç¤ºè¯é…ç½®
  `prompt_template_snapshot` text COMMENT 'æç¤ºè¯æ¨¡æ¿å¿«ç…§ï¼ˆè®°å½•ä½¿ç”¨æ—¶çš„æ¨¡æ¿å†…å®¹ï¼‰',
  `prompt_variables` json DEFAULT NULL COMMENT 'å¡«å……çš„æ¨¡æ¿å˜é‡ï¼ˆJSONå¯¹è±¡ï¼‰',
  `system_prompt` text COMMENT 'å®é™…ä½¿ç”¨çš„ç³»ç»Ÿæç¤ºè¯',
  `user_prompt` text COMMENT 'å®é™…ä½¿ç”¨çš„ç”¨æˆ·æç¤ºè¯',
  `generation_params` json DEFAULT NULL COMMENT 'ç”Ÿæˆå‚æ•°ï¼ˆtemperature, max_tokensç­‰ï¼‰',
  
  -- ç”Ÿæˆç»“æœ
  `generated_title` varchar(255) DEFAULT NULL COMMENT 'ç”Ÿæˆçš„æ ‡é¢˜',
  `generated_content` longtext COMMENT 'ç”Ÿæˆçš„å†…å®¹',
  `content_hash` varchar(64) DEFAULT NULL COMMENT 'å†…å®¹å“ˆå¸Œï¼ˆç”¨äºå»é‡ï¼‰',
  
  -- ç»Ÿè®¡ä¿¡æ¯
  `input_tokens` int DEFAULT 0 COMMENT 'è¾“å…¥Tokenæ•°',
  `output_tokens` int DEFAULT 0 COMMENT 'è¾“å‡ºTokenæ•°',
  `total_tokens` int DEFAULT 0 COMMENT 'æ€»Tokenæ•°',
  `generation_cost` decimal(10,6) DEFAULT 0.000000 COMMENT 'ç”Ÿæˆæˆæœ¬',
  `generation_time_ms` int DEFAULT 0 COMMENT 'ç”Ÿæˆè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰',
  
  -- è´¨é‡è¯„ä¼°
  `quality_score` decimal(3,2) DEFAULT NULL COMMENT 'è´¨é‡è¯„åˆ†ï¼ˆ0-1ï¼‰',
  `is_approved` tinyint DEFAULT NULL COMMENT 'æ˜¯å¦é‡‡ç”¨ï¼šnull-å¾…å®¡æ ¸ 0-å¦ 1-æ˜¯',
  `review_note` text COMMENT 'å®¡æ ¸å¤‡æ³¨',
  `reviewed_by` bigint DEFAULT NULL COMMENT 'å®¡æ ¸äºº',
  `reviewed_at` datetime DEFAULT NULL COMMENT 'å®¡æ ¸æ—¶é—´',
  
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-å¤±è´¥ 1-æˆåŠŸ 2-è¿›è¡Œä¸­',
  `error_message` text COMMENT 'é”™è¯¯ä¿¡æ¯',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_ai_platform_id` (`ai_platform_id`),
  KEY `idx_prompt_template_id` (`prompt_template_id`),
  KEY `idx_generation_version` (`generation_version`),
  KEY `idx_is_approved` (`is_approved`),
  KEY `idx_status` (`status`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡ç« ç”Ÿæˆè®°å½•è¡¨';
```

### 4.9 æ–‡ç« èµ„æºè¡¨ (gb_article_resources)

å­˜å‚¨æ–‡ç« ä¸­å¼•ç”¨çš„å›¾ç‰‡ã€è§†é¢‘ç­‰èµ„æºï¼Œæ”¯æŒæ‰¹é‡ä¿®æ”¹å­˜å‚¨ä½ç½®ã€‚

```sql
CREATE TABLE `gb_article_resources` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `article_id` bigint NOT NULL COMMENT 'æ–‡ç« ID',
  `resource_type` varchar(20) NOT NULL COMMENT 'èµ„æºç±»å‹ï¼šimage-å›¾ç‰‡ video-è§†é¢‘ audio-éŸ³é¢‘ file-æ–‡ä»¶',
  `name` varchar(255) DEFAULT NULL COMMENT 'èµ„æºåç§°',
  `original_name` varchar(255) DEFAULT NULL COMMENT 'åŸå§‹æ–‡ä»¶å',
  
  -- å­˜å‚¨ä¿¡æ¯
  `storage_config_id` bigint NOT NULL COMMENT 'å­˜å‚¨é…ç½®ID',
  `storage_key` varchar(500) NOT NULL COMMENT 'å­˜å‚¨é”®/è·¯å¾„',
  `storage_url` varchar(1000) NOT NULL COMMENT 'å®Œæ•´è®¿é—®URL',
  `cdn_url` varchar(1000) DEFAULT NULL COMMENT 'CDNåŠ é€ŸURL',
  
  -- åŸå§‹å­˜å‚¨ä¿¡æ¯ï¼ˆç”¨äºè¿ç§»è¿½è¸ªï¼‰
  `original_storage_config_id` bigint DEFAULT NULL COMMENT 'åŸå§‹å­˜å‚¨é…ç½®ID',
  `original_storage_key` varchar(500) DEFAULT NULL COMMENT 'åŸå§‹å­˜å‚¨é”®',
  `original_url` varchar(1000) DEFAULT NULL COMMENT 'åŸå§‹URL',
  
  -- åœ¨æ–‡ç« ä¸­çš„ä½ç½®
  `position_in_content` int DEFAULT NULL COMMENT 'åœ¨æ–‡ç« å†…å®¹ä¸­çš„ä½ç½®ç´¢å¼•',
  `markdown_ref` varchar(500) DEFAULT NULL COMMENT 'Markdownå¼•ç”¨æ ¼å¼ï¼ˆå¦‚ ![alt](url)ï¼‰',
  `alt_text` varchar(255) DEFAULT NULL COMMENT 'æ›¿ä»£æ–‡æœ¬ï¼ˆå›¾ç‰‡altï¼‰',
  `caption` varchar(500) DEFAULT NULL COMMENT 'æ ‡é¢˜/è¯´æ˜',
  
  -- æ–‡ä»¶ä¿¡æ¯
  `file_size` bigint DEFAULT 0 COMMENT 'æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰',
  `mime_type` varchar(100) DEFAULT NULL COMMENT 'MIMEç±»å‹',
  `width` int DEFAULT 0 COMMENT 'å®½åº¦ï¼ˆåƒç´ ï¼Œå›¾ç‰‡/è§†é¢‘ï¼‰',
  `height` int DEFAULT 0 COMMENT 'é«˜åº¦ï¼ˆåƒç´ ï¼Œå›¾ç‰‡/è§†é¢‘ï¼‰',
  `duration` int DEFAULT 0 COMMENT 'æ—¶é•¿ï¼ˆç§’ï¼Œè§†é¢‘/éŸ³é¢‘ï¼‰',
  `hash` varchar(64) DEFAULT NULL COMMENT 'æ–‡ä»¶å“ˆå¸Œï¼ˆMD5/SHA256ï¼‰',
  
  -- è¿ç§»çŠ¶æ€
  `migration_status` varchar(20) DEFAULT 'none' COMMENT 'è¿ç§»çŠ¶æ€ï¼šnone-æœªè¿ç§» pending-å¾…è¿ç§» migrating-è¿ç§»ä¸­ completed-å·²å®Œæˆ failed-å¤±è´¥',
  `migrated_at` datetime DEFAULT NULL COMMENT 'è¿ç§»å®Œæˆæ—¶é—´',
  `migration_error` text COMMENT 'è¿ç§»é”™è¯¯ä¿¡æ¯',
  
  `sort_order` int DEFAULT 0 COMMENT 'æ’åº',
  `status` tinyint DEFAULT 1 COMMENT 'çŠ¶æ€ï¼š0-ç¦ç”¨ 1-å¯ç”¨',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_resource_type` (`resource_type`),
  KEY `idx_storage_config_id` (`storage_config_id`),
  KEY `idx_migration_status` (`migration_status`),
  KEY `idx_hash` (`hash`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡ç« èµ„æºè¡¨';
```

### 4.10 å­˜å‚¨è¿ç§»è§„åˆ™è¡¨ (gb_storage_migration_rules)

å®šä¹‰èµ„æºå­˜å‚¨ä½ç½®æ‰¹é‡ä¿®æ”¹çš„è§„åˆ™ã€‚

```sql
CREATE TABLE `gb_storage_migration_rules` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `name` varchar(100) NOT NULL COMMENT 'è§„åˆ™åç§°',
  `description` text COMMENT 'è§„åˆ™æè¿°',
  `rule_type` varchar(30) NOT NULL COMMENT 'è§„åˆ™ç±»å‹ï¼šurl_replace-URLæ›¿æ¢ storage_move-å­˜å‚¨è¿ç§» path_rewrite-è·¯å¾„é‡å†™ domain_change-åŸŸåæ›´æ¢',
  
  -- æºåŒ¹é…æ¡ä»¶
  `source_storage_config_id` bigint DEFAULT NULL COMMENT 'æºå­˜å‚¨é…ç½®IDï¼ˆNULLè¡¨ç¤ºåŒ¹é…æ‰€æœ‰ï¼‰',
  `source_url_pattern` varchar(500) DEFAULT NULL COMMENT 'æºURLåŒ¹é…æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰',
  `source_path_pattern` varchar(500) DEFAULT NULL COMMENT 'æºè·¯å¾„åŒ¹é…æ¨¡å¼ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰',
  `source_domain` varchar(255) DEFAULT NULL COMMENT 'æºåŸŸå',
  
  -- ç›®æ ‡é…ç½®
  `target_storage_config_id` bigint NOT NULL COMMENT 'ç›®æ ‡å­˜å‚¨é…ç½®ID',
  `target_url_template` varchar(500) DEFAULT NULL COMMENT 'ç›®æ ‡URLæ¨¡æ¿ï¼ˆæ”¯æŒå˜é‡æ›¿æ¢ï¼‰',
  `target_path_template` varchar(500) DEFAULT NULL COMMENT 'ç›®æ ‡è·¯å¾„æ¨¡æ¿ï¼ˆæ”¯æŒå˜é‡æ›¿æ¢ï¼‰',
  `target_domain` varchar(255) DEFAULT NULL COMMENT 'ç›®æ ‡åŸŸå',
  
  -- åº”ç”¨èŒƒå›´
  `apply_scope` varchar(30) DEFAULT 'all' COMMENT 'åº”ç”¨èŒƒå›´ï¼šall-æ‰€æœ‰ site-æŒ‡å®šç½‘ç«™ category-æŒ‡å®šåˆ†ç±» article-æŒ‡å®šæ–‡ç« ',
  `scope_ids` json DEFAULT NULL COMMENT 'èŒƒå›´IDåˆ—è¡¨ï¼ˆJSONæ•°ç»„ï¼‰',
  `resource_types` json DEFAULT NULL COMMENT 'é€‚ç”¨èµ„æºç±»å‹ï¼ˆJSONæ•°ç»„ï¼ŒNULLè¡¨ç¤ºæ‰€æœ‰ï¼‰',
  
  -- æ‰§è¡Œé…ç½®
  `is_copy` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦å¤åˆ¶ï¼ˆè€Œéç§»åŠ¨ï¼‰ï¼š0-ç§»åŠ¨ 1-å¤åˆ¶',
  `update_content` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦æ›´æ–°æ–‡ç« å†…å®¹ä¸­çš„å¼•ç”¨ï¼š0-å¦ 1-æ˜¯',
  `delete_source` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦åˆ é™¤æºæ–‡ä»¶ï¼š0-å¦ 1-æ˜¯',
  `backup_before` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦åœ¨è¿ç§»å‰å¤‡ä»½ï¼š0-å¦ 1-æ˜¯',
  
  -- æ‰§è¡ŒçŠ¶æ€
  `execution_status` varchar(20) DEFAULT 'pending' COMMENT 'æ‰§è¡ŒçŠ¶æ€ï¼špending-å¾…æ‰§è¡Œ running-æ‰§è¡Œä¸­ completed-å·²å®Œæˆ failed-å¤±è´¥ cancelled-å·²å–æ¶ˆ',
  `total_count` int DEFAULT 0 COMMENT 'æ€»èµ„æºæ•°',
  `processed_count` int DEFAULT 0 COMMENT 'å·²å¤„ç†æ•°',
  `success_count` int DEFAULT 0 COMMENT 'æˆåŠŸæ•°',
  `fail_count` int DEFAULT 0 COMMENT 'å¤±è´¥æ•°',
  `started_at` datetime DEFAULT NULL COMMENT 'å¼€å§‹æ‰§è¡Œæ—¶é—´',
  `completed_at` datetime DEFAULT NULL COMMENT 'å®Œæˆæ—¶é—´',
  `error_log` text COMMENT 'é”™è¯¯æ—¥å¿—',
  
  `priority` int DEFAULT 0 COMMENT 'ä¼˜å…ˆçº§ï¼ˆæ•°å€¼è¶Šå¤§ä¼˜å…ˆçº§è¶Šé«˜ï¼‰',
  `is_enabled` tinyint DEFAULT 1 COMMENT 'æ˜¯å¦å¯ç”¨ï¼š0-å¦ 1-æ˜¯',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_rule_type` (`rule_type`),
  KEY `idx_source_storage` (`source_storage_config_id`),
  KEY `idx_target_storage` (`target_storage_config_id`),
  KEY `idx_execution_status` (`execution_status`),
  KEY `idx_is_enabled` (`is_enabled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å­˜å‚¨è¿ç§»è§„åˆ™è¡¨';
```

**è§„åˆ™ç±»å‹è¯´æ˜ï¼š**

| rule_type | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|-----------|------|---------|
| url_replace | URLæ›¿æ¢ | ç®€å•çš„åŸŸåæˆ–è·¯å¾„æ›¿æ¢ |
| storage_move | å­˜å‚¨è¿ç§» | å°†æ–‡ä»¶ä»ä¸€ä¸ªå­˜å‚¨ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå­˜å‚¨ |
| path_rewrite | è·¯å¾„é‡å†™ | ä¿æŒå­˜å‚¨ä¸å˜ï¼Œä¿®æ”¹è·¯å¾„ç»“æ„ |
| domain_change | åŸŸåæ›´æ¢ | æ›´æ¢CDNæˆ–è®¿é—®åŸŸå |

**URLæ¨¡æ¿å˜é‡ï¼š**

| å˜é‡ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `{filename}` | æ–‡ä»¶åï¼ˆä¸å«è·¯å¾„ï¼‰ | `image.png` |
| `{ext}` | æ–‡ä»¶æ‰©å±•å | `png` |
| `{hash}` | æ–‡ä»¶å“ˆå¸Œ | `a1b2c3d4...` |
| `{date}` | æ—¥æœŸ | `2025/12/14` |
| `{article_id}` | æ–‡ç« ID | `123` |
| `{site_id}` | ç½‘ç«™ID | `1` |
| `{original_path}` | åŸå§‹è·¯å¾„ | `images/old/image.png` |

### 4.11 å­˜å‚¨è¿ç§»æ—¥å¿—è¡¨ (gb_storage_migration_logs)

è®°å½•æ¯æ¬¡èµ„æºè¿ç§»çš„è¯¦ç»†æ—¥å¿—ã€‚

```sql
CREATE TABLE `gb_storage_migration_logs` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `rule_id` bigint NOT NULL COMMENT 'è¿ç§»è§„åˆ™ID',
  `resource_id` bigint NOT NULL COMMENT 'èµ„æºID',
  `article_id` bigint DEFAULT NULL COMMENT 'æ–‡ç« ID',
  
  -- è¿ç§»å‰åä¿¡æ¯
  `source_storage_config_id` bigint DEFAULT NULL COMMENT 'æºå­˜å‚¨é…ç½®ID',
  `source_url` varchar(1000) DEFAULT NULL COMMENT 'æºURL',
  `source_path` varchar(500) DEFAULT NULL COMMENT 'æºè·¯å¾„',
  `target_storage_config_id` bigint DEFAULT NULL COMMENT 'ç›®æ ‡å­˜å‚¨é…ç½®ID',
  `target_url` varchar(1000) DEFAULT NULL COMMENT 'ç›®æ ‡URL',
  `target_path` varchar(500) DEFAULT NULL COMMENT 'ç›®æ ‡è·¯å¾„',
  
  -- æ‰§è¡Œç»“æœ
  `status` varchar(20) NOT NULL COMMENT 'çŠ¶æ€ï¼šsuccess-æˆåŠŸ failed-å¤±è´¥ skipped-è·³è¿‡',
  `error_message` text COMMENT 'é”™è¯¯ä¿¡æ¯',
  `file_size` bigint DEFAULT 0 COMMENT 'æ–‡ä»¶å¤§å°',
  `duration_ms` int DEFAULT 0 COMMENT 'è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰',
  
  -- å†…å®¹æ›´æ–°
  `content_updated` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦æ›´æ–°äº†æ–‡ç« å†…å®¹ï¼š0-å¦ 1-æ˜¯',
  `old_content_ref` text COMMENT 'æ—§çš„å†…å®¹å¼•ç”¨',
  `new_content_ref` text COMMENT 'æ–°çš„å†…å®¹å¼•ç”¨',
  
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_rule_id` (`rule_id`),
  KEY `idx_resource_id` (`resource_id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_status` (`status`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å­˜å‚¨è¿ç§»æ—¥å¿—è¡¨';
```

### 4.12 å­˜å‚¨å®¹é‡ä½¿ç”¨è®°å½•è¡¨ (gb_storage_capacity_logs)

è®°å½•å­˜å‚¨å®¹é‡çš„å˜åŒ–å†å²ï¼Œç”¨äºå®¹é‡ç›‘æ§å’Œè¶‹åŠ¿åˆ†æã€‚

```sql
CREATE TABLE `gb_storage_capacity_logs` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `storage_config_id` bigint NOT NULL COMMENT 'å­˜å‚¨é…ç½®ID',
  `log_type` varchar(20) NOT NULL COMMENT 'æ—¥å¿—ç±»å‹ï¼šupload-ä¸Šä¼  delete-åˆ é™¤ sync-åŒæ­¥æ›´æ–° manual-æ‰‹åŠ¨è°ƒæ•´',
  
  -- å˜åŒ–ä¿¡æ¯
  `file_count_change` int DEFAULT 0 COMMENT 'æ–‡ä»¶æ•°é‡å˜åŒ–ï¼ˆæ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘ï¼‰',
  `capacity_change` bigint DEFAULT 0 COMMENT 'å®¹é‡å˜åŒ–ï¼ˆå­—èŠ‚ï¼Œæ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘ï¼‰',
  `file_count_after` int DEFAULT 0 COMMENT 'å˜åŒ–åæ–‡ä»¶æ•°é‡',
  `capacity_after` bigint DEFAULT 0 COMMENT 'å˜åŒ–åå®¹é‡ï¼ˆå­—èŠ‚ï¼‰',
  `capacity_percent` decimal(5,2) DEFAULT NULL COMMENT 'å®¹é‡ä½¿ç”¨ç™¾åˆ†æ¯”',
  
  -- å…³è”ä¿¡æ¯
  `article_id` bigint DEFAULT NULL COMMENT 'å…³è”æ–‡ç« ID',
  `resource_id` bigint DEFAULT NULL COMMENT 'å…³è”èµ„æºID',
  `file_path` varchar(500) DEFAULT NULL COMMENT 'æ–‡ä»¶è·¯å¾„',
  `file_size` bigint DEFAULT 0 COMMENT 'æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰',
  
  -- è§¦å‘ä¿¡æ¯
  `trigger_source` varchar(50) DEFAULT NULL COMMENT 'è§¦å‘æ¥æºï¼šapi/batch_task/migration/cron/manual',
  `trigger_user_id` bigint DEFAULT NULL COMMENT 'è§¦å‘ç”¨æˆ·ID',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_storage_config_id` (`storage_config_id`),
  KEY `idx_log_type` (`log_type`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_resource_id` (`resource_id`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å­˜å‚¨å®¹é‡ä½¿ç”¨è®°å½•è¡¨';
```

**å®¹é‡å˜åŒ–åœºæ™¯ï¼š**

| log_type | è¯´æ˜ | å…¸å‹åœºæ™¯ |
|----------|------|---------|
| upload | ä¸Šä¼ æ–‡ä»¶ | æ–°å¢æ–‡ç« ã€ä¸Šä¼ èµ„æº |
| delete | åˆ é™¤æ–‡ä»¶ | åˆ é™¤æ–‡ç« ã€ç§»é™¤èµ„æº |
| sync | åŒæ­¥æ›´æ–° | å®šæ—¶ä»»åŠ¡åŒæ­¥å®é™…å®¹é‡ |
| manual | æ‰‹åŠ¨è°ƒæ•´ | ç®¡ç†å‘˜æ‰‹åŠ¨è°ƒæ•´å®¹é‡å€¼ |

### 4.13 æ–‡ç« -äº§å“å…³è”è¡¨ (gb_article_product_relations)

æ–‡ç« å¯ä»¥å…³è”å¤šç§äº§å“ç±»å‹ï¼ˆæ¸¸æˆã€æ¸¸æˆç›’å­ã€çŸ­å‰§ç­‰ï¼‰ã€‚

```sql
CREATE TABLE `gb_article_product_relations` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `article_id` bigint NOT NULL COMMENT 'æ–‡ç« ID',
  `product_type` varchar(20) NOT NULL COMMENT 'äº§å“ç±»å‹ï¼šgame/game_box/drama/drama_vendor',
  `product_id` bigint NOT NULL COMMENT 'äº§å“ID',
  `relation_type` varchar(20) DEFAULT 'manual' COMMENT 'å…³è”ç±»å‹ï¼šauto-è‡ªåŠ¨ manual-æ‰‹åŠ¨',
  `is_primary` tinyint DEFAULT 0 COMMENT 'æ˜¯å¦ä¸»å…³è”ï¼š0-å¦ 1-æ˜¯',
  `display_order` int DEFAULT 0 COMMENT 'æ˜¾ç¤ºé¡ºåº',
  `created_by` bigint DEFAULT NULL COMMENT 'åˆ›å»ºäºº',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_article_product` (`article_id`, `product_type`, `product_id`),
  KEY `idx_article_id` (`article_id`),
  KEY `idx_product_type` (`product_type`),
  KEY `idx_product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ–‡ç« -äº§å“å…³è”è¡¨';
```

**äº§å“å…³è”ç¤ºæ„å›¾ï¼š**

```mermaid
flowchart TB
    subgraph æ–‡ç« 
        A1[æ”»ç•¥æ–‡ç« 1]
        A2[æ¨å¹¿æ–‡ç« 2]
        A3[æµ‹è¯„æ–‡ç« 3]
    end
    
    subgraph æ¸¸æˆäº§å“
        G1[åŸç¥]
        G2[ç‹è€…è£è€€]
        GB1[3733æ¸¸æˆç›’]
    end
    
    subgraph çŸ­å‰§äº§å“
        D1[éœ¸é“æ€»è£çˆ±ä¸Šæˆ‘]
        DV1[ä¹å·çŸ­å‰§]
    end
    
    A1 -->|game| G1
    A1 -->|game| G2
    A2 -->|game_box| GB1
    A2 -->|game| G1
    A3 -->|drama| D1
    A3 -->|drama_vendor| DV1
```

---

## 5. ç»Ÿè®¡åˆ†æåº“è¡¨è®¾è®¡

### 5.1 æœç´¢æ—¥å¿—è¡¨ (gb_search_logs)

```sql
CREATE TABLE `gb_search_logs` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `query` varchar(255) NOT NULL COMMENT 'æœç´¢å…³é”®è¯',
  `query_normalized` varchar(255) DEFAULT NULL COMMENT 'æ ‡å‡†åŒ–åçš„å…³é”®è¯',
  `search_type` varchar(20) DEFAULT 'all' COMMENT 'æœç´¢ç±»å‹ï¼šall/game/drama/article',
  `result_count` int DEFAULT 0 COMMENT 'ç»“æœæ•°é‡',
  `search_time_ms` int DEFAULT 0 COMMENT 'æœç´¢è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰',
  `filters` json DEFAULT NULL COMMENT 'ç­›é€‰æ¡ä»¶ï¼ˆJSONï¼‰',
  `user_id` bigint DEFAULT NULL COMMENT 'ç”¨æˆ·IDï¼ˆå¯é€‰ï¼‰',
  `session_id` varchar(100) DEFAULT NULL COMMENT 'ä¼šè¯ID',
  `ip_address` varchar(45) DEFAULT NULL COMMENT 'IPåœ°å€',
  `user_agent` varchar(500) DEFAULT NULL COMMENT 'ç”¨æˆ·ä»£ç†',
  `referer` varchar(500) DEFAULT NULL COMMENT 'æ¥æºé¡µé¢',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'æœç´¢æ—¶é—´',
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_query` (`query`),
  KEY `idx_search_type` (`search_type`),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_session` (`session_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æœç´¢æ—¥å¿—è¡¨';
```

### 5.2 é¡µé¢æµè§ˆè¡¨ (gb_page_views)

```sql
CREATE TABLE `gb_page_views` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `content_type` varchar(20) DEFAULT NULL COMMENT 'å†…å®¹ç±»å‹ï¼šdocument/article/game/drama',
  `content_id` bigint DEFAULT NULL COMMENT 'å†…å®¹ID',
  `page_path` varchar(500) NOT NULL COMMENT 'é¡µé¢è·¯å¾„',
  `page_title` varchar(255) DEFAULT NULL COMMENT 'é¡µé¢æ ‡é¢˜',
  `referer` varchar(500) DEFAULT NULL COMMENT 'æ¥æºé¡µé¢',
  `user_id` bigint DEFAULT NULL COMMENT 'ç”¨æˆ·ID',
  `session_id` varchar(100) DEFAULT NULL COMMENT 'ä¼šè¯ID',
  `ip_address` varchar(45) DEFAULT NULL COMMENT 'IPåœ°å€',
  `country` varchar(50) DEFAULT NULL COMMENT 'å›½å®¶',
  `city` varchar(50) DEFAULT NULL COMMENT 'åŸå¸‚',
  `device_type` varchar(20) DEFAULT NULL COMMENT 'è®¾å¤‡ç±»å‹ï¼šmobile/tablet/desktop',
  `browser` varchar(50) DEFAULT NULL COMMENT 'æµè§ˆå™¨',
  `os` varchar(50) DEFAULT NULL COMMENT 'æ“ä½œç³»ç»Ÿ',
  `duration_seconds` int DEFAULT 0 COMMENT 'åœç•™æ—¶é•¿ï¼ˆç§’ï¼‰',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `idx_site_id` (`site_id`),
  KEY `idx_content` (`content_type`, `content_id`),
  KEY `idx_page_path` (`page_path`(191)),
  KEY `idx_created_at` (`created_at`),
  KEY `idx_session` (`session_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='é¡µé¢æµè§ˆè®°å½•è¡¨';
```

### 5.3 æ¯æ—¥ç»Ÿè®¡æ±‡æ€»è¡¨ (gb_daily_stats)

```sql
CREATE TABLE `gb_daily_stats` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `stat_date` date NOT NULL COMMENT 'ç»Ÿè®¡æ—¥æœŸ',
  `stat_type` varchar(50) NOT NULL COMMENT 'ç»Ÿè®¡ç±»å‹',
  `content_type` varchar(20) DEFAULT NULL COMMENT 'å†…å®¹ç±»å‹ï¼šgame/drama/article/document',
  `dimension` varchar(100) DEFAULT 'total' COMMENT 'ç»´åº¦ï¼ˆåˆ†ç±»ã€è®¾å¤‡ç­‰ï¼‰',
  `dimension_value` varchar(100) DEFAULT NULL COMMENT 'ç»´åº¦å€¼',
  `pv` int DEFAULT 0 COMMENT 'é¡µé¢æµè§ˆé‡',
  `uv` int DEFAULT 0 COMMENT 'ç‹¬ç«‹è®¿å®¢',
  `search_count` int DEFAULT 0 COMMENT 'æœç´¢æ¬¡æ•°',
  `download_count` int DEFAULT 0 COMMENT 'ä¸‹è½½æ¬¡æ•°',
  `new_contents` int DEFAULT 0 COMMENT 'æ–°å¢å†…å®¹æ•°',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_date_type_dim` (`site_id`, `stat_date`, `stat_type`, `dimension`, `dimension_value`),
  KEY `idx_stat_date` (`stat_date`),
  KEY `idx_stat_type` (`stat_type`),
  KEY `idx_content_type` (`content_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='æ¯æ—¥ç»Ÿè®¡æ±‡æ€»è¡¨';
```

### 5.4 çƒ­é—¨æœç´¢è¯è¡¨ (gb_hot_keywords)

```sql
CREATE TABLE `gb_hot_keywords` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `keyword` varchar(100) NOT NULL COMMENT 'å…³é”®è¯',
  `search_type` varchar(20) DEFAULT 'all' COMMENT 'æœç´¢ç±»å‹ï¼šall/game/drama',
  `search_count` int DEFAULT 0 COMMENT 'æœç´¢æ¬¡æ•°',
  `click_count` int DEFAULT 0 COMMENT 'ç‚¹å‡»æ¬¡æ•°',
  `ctr` decimal(5,4) DEFAULT 0.0000 COMMENT 'ç‚¹å‡»ç‡',
  `avg_position` decimal(4,2) DEFAULT 0.00 COMMENT 'å¹³å‡æ’åä½ç½®',
  `stat_date` date NOT NULL COMMENT 'ç»Ÿè®¡æ—¥æœŸ',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_keyword_date` (`site_id`, `keyword`, `stat_date`),
  KEY `idx_stat_date` (`stat_date`),
  KEY `idx_search_count` (`search_count` DESC)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='çƒ­é—¨æœç´¢è¯è¡¨';
```

### 5.5 AIç”Ÿæˆç»Ÿè®¡è¡¨ (gb_ai_generation_stats)

```sql
CREATE TABLE `gb_ai_generation_stats` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®ID',
  `site_id` bigint DEFAULT NULL COMMENT 'æ‰€å±ç½‘ç«™ID',
  `ai_platform_id` bigint NOT NULL COMMENT 'AIå¹³å°ID',
  `stat_date` date NOT NULL COMMENT 'ç»Ÿè®¡æ—¥æœŸ',
  `generation_count` int DEFAULT 0 COMMENT 'ç”Ÿæˆæ¬¡æ•°',
  `success_count` int DEFAULT 0 COMMENT 'æˆåŠŸæ¬¡æ•°',
  `fail_count` int DEFAULT 0 COMMENT 'å¤±è´¥æ¬¡æ•°',
  `total_input_tokens` bigint DEFAULT 0 COMMENT 'æ€»è¾“å…¥Token',
  `total_output_tokens` bigint DEFAULT 0 COMMENT 'æ€»è¾“å‡ºToken',
  `total_cost` decimal(12,6) DEFAULT 0.000000 COMMENT 'æ€»æˆæœ¬',
  `avg_generation_time_ms` int DEFAULT 0 COMMENT 'å¹³å‡ç”Ÿæˆè€—æ—¶',
  `avg_quality_score` decimal(3,2) DEFAULT NULL COMMENT 'å¹³å‡è´¨é‡è¯„åˆ†',
  `approved_count` int DEFAULT 0 COMMENT 'é‡‡ç”¨æ¬¡æ•°',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP,
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_site_platform_date` (`site_id`, `ai_platform_id`, `stat_date`),
  KEY `idx_stat_date` (`stat_date`),
  KEY `idx_ai_platform_id` (`ai_platform_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='AIç”Ÿæˆç»Ÿè®¡è¡¨';
```

---

## 6. ElasticSearch ç´¢å¼•è®¾è®¡

### 6.1 æ–‡æ¡£ç´¢å¼• (documents)

```json
{
  "settings": {
    "number_of_shards": 3,
    "number_of_replicas": 1,
    "analysis": {
      "analyzer": {
        "ik_smart_synonym": {
          "type": "custom",
          "tokenizer": "ik_smart",
          "filter": ["lowercase", "synonym_filter"]
        },
        "ik_max_synonym": {
          "type": "custom",
          "tokenizer": "ik_max_word",
          "filter": ["lowercase", "synonym_filter"]
        }
      },
      "filter": {
        "synonym_filter": {
          "type": "synonym",
          "synonyms_path": "analysis/synonyms.txt"
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "id": { "type": "long" },
      "site_id": { "type": "long" },
      "slug": { "type": "keyword" },
      "title": {
        "type": "text",
        "analyzer": "ik_max_synonym",
        "search_analyzer": "ik_smart_synonym",
        "fields": {
          "keyword": { "type": "keyword" }
        }
      },
      "category": { "type": "keyword" },
      "subcategory": { "type": "keyword" },
      "keywords": {
        "type": "text",
        "analyzer": "ik_max_synonym"
      },
      "content": {
        "type": "text",
        "analyzer": "ik_max_synonym",
        "search_analyzer": "ik_smart_synonym"
      },
      "description": { "type": "text", "analyzer": "ik_smart" },
      "tags": { "type": "keyword" },
      "storage_type": { "type": "keyword" },
      "storage_url": { "type": "keyword" },
      "publish_year": { "type": "integer" },
      "publish_month": { "type": "integer" },
      "view_count": { "type": "integer" },
      "like_count": { "type": "integer" },
      "published_at": { "type": "date" },
      "created_at": { "type": "date" },
      "updated_at": { "type": "date" },
      "suggest": {
        "type": "completion",
        "analyzer": "ik_smart"
      }
    }
  }
}
```

### 6.2 æ¸¸æˆç´¢å¼• (games)

```json
{
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 1
  },
  "mappings": {
    "properties": {
      "id": { "type": "long" },
      "site_id": { "type": "long" },
      "name": {
        "type": "text",
        "analyzer": "ik_max_word",
        "fields": { "keyword": { "type": "keyword" } }
      },
      "category": { "type": "keyword" },
      "description": { "type": "text", "analyzer": "ik_smart" },
      "tags": { "type": "keyword" },
      "features": { "type": "keyword" },
      "box_ids": { "type": "long" },
      "download_count": { "type": "integer" },
      "rating": { "type": "float" },
      "created_at": { "type": "date" }
    }
  }
}
```

### 6.3 çŸ­å‰§ç´¢å¼• (dramas)

```json
{
  "settings": {
    "number_of_shards": 1,
    "number_of_replicas": 1
  },
  "mappings": {
    "properties": {
      "id": { "type": "long" },
      "site_id": { "type": "long" },
      "vendor_id": { "type": "long" },
      "name": {
        "type": "text",
        "analyzer": "ik_max_word",
        "fields": { "keyword": { "type": "keyword" } }
      },
      "alias_name": { "type": "text", "analyzer": "ik_smart" },
      "category": { "type": "keyword" },
      "genre": { "type": "keyword" },
      "description": { "type": "text", "analyzer": "ik_smart" },
      "actors": { "type": "keyword" },
      "tags": { "type": "keyword" },
      "episode_count": { "type": "integer" },
      "play_count": { "type": "long" },
      "rating": { "type": "float" },
      "is_hot": { "type": "boolean" },
      "is_new": { "type": "boolean" },
      "release_date": { "type": "date" },
      "created_at": { "type": "date" }
    }
  }
}
```

### 6.4 æ–‡ç« ç´¢å¼• (articles)

```json
{
  "settings": {
    "number_of_shards": 2,
    "number_of_replicas": 1
  },
  "mappings": {
    "properties": {
      "id": { "type": "long" },
      "site_id": { "type": "long" },
      "slug": { "type": "keyword" },
      "title": {
        "type": "text",
        "analyzer": "ik_max_word",
        "fields": { "keyword": { "type": "keyword" } }
      },
      "subtitle": { "type": "text", "analyzer": "ik_smart" },
      "category": { "type": "keyword" },
      "keywords": { "type": "text", "analyzer": "ik_max_word" },
      "description": { "type": "text", "analyzer": "ik_smart" },
      "content": { "type": "text", "analyzer": "ik_max_word" },
      "author": { "type": "keyword" },
      "is_ai_generated": { "type": "boolean" },
      "related_products": {
        "type": "nested",
        "properties": {
          "product_type": { "type": "keyword" },
          "product_id": { "type": "long" },
          "product_name": { "type": "keyword" }
        }
      },
      "publish_year": { "type": "integer" },
      "publish_month": { "type": "integer" },
      "view_count": { "type": "integer" },
      "like_count": { "type": "integer" },
      "published_at": { "type": "date" },
      "created_at": { "type": "date" }
    }
  }
}
```

---

## 7. æ•°æ®å­—å…¸

### 7.1 çŠ¶æ€æšä¸¾

| å­—æ®µ | å€¼ | è¯´æ˜ |
|------|-----|------|
| status | 0 | ç¦ç”¨/ä¸‹æ¶ |
| status | 1 | å¯ç”¨/ä¸Šæ¶ |
| is_published | 0 | æœªå‘å¸ƒ |
| is_published | 1 | å·²å‘å¸ƒ |
| relation_type | auto | è‡ªåŠ¨å…³è” |
| relation_type | manual | æ‰‹åŠ¨å…³è” |

### 7.2 æ¸¸æˆç±»å‹

| game_type | è¯´æ˜ | å…¸å‹æŠ˜æ‰£ |
|-----------|------|---------|
| official | å®˜æ–¹æ­£ç‰ˆæ¸¸æˆ | æ— æŠ˜æ‰£æˆ–å°‘é‡æŠ˜æ‰£ |
| discount | æŠ˜æ‰£æ¸¸æˆ | 0.1æŠ˜ã€1æŠ˜ç­‰ |
| bt | BTç‰ˆ/å˜æ€ç‰ˆ | é«˜ç¦åˆ©ã€é«˜è¿”åˆ© |
| coming | å³å°†ä¸Šçº¿ | é¢„çº¦ä¸­ |

### 7.3 è®¾å¤‡æ”¯æŒç±»å‹

| device_support | è¯´æ˜ | æ˜¾ç¤º |
|----------------|------|------|
| android | ä»…å®‰å“ | ğŸ“± |
| ios | ä»…iOS | ğŸ |
| both | åŒç«¯äº’é€š | ğŸ“±ğŸ |

### 7.4 ç¤¼åŒ…ç±»å‹

| gift_type | åç§° | è¯´æ˜ |
|-----------|------|------|
| newbie | æ–°æ‰‹ç¤¼åŒ… | æ–°æ‰‹å¡ï¼Œæ–°ç©å®¶é¢†å– |
| reserve | é¢„çº¦ç¤¼åŒ… | é¢„çº¦æ¸¸æˆå¯é¢† |
| community | ç¤¾åŒºç¤¼åŒ… | ç¤¾åŒºæ´»åŠ¨ç¤¼åŒ… |
| welfare | ç¦åˆ©ç¤¼åŒ… | é€šç”¨ç¦åˆ©ç¤¼åŒ… |
| exclusive | ç‹¬å ç¤¼åŒ… | ç‰¹å®šç›’å­ç‹¬å  |

### 7.5 æ´»åŠ¨ç±»å‹

| activity_type | è¯´æ˜ |
|---------------|------|
| activity | æ¸¸æˆæ´»åŠ¨ |
| server | å¼€æœæ´»åŠ¨ |
| other | å…¶ä»–æ´»åŠ¨ |

### 7.6 ç´ æç±»å‹

| material_type | è¯´æ˜ |
|---------------|------|
| icon | æ¸¸æˆå›¾æ ‡ |
| cover | å°é¢å›¾ |
| screenshot | æ¸¸æˆæˆªå›¾ |
| video | æ¸¸æˆè§†é¢‘ |
| poster | æµ·æŠ¥/å®£ä¼ å¡ç‰‡ |
| qrcode | äºŒç»´ç  |

### 7.7 ç½‘ç«™ç±»å‹

| site_type | è¯´æ˜ |
|-----------|------|
| game | æ¸¸æˆæ¨å¹¿ç½‘ç«™ |
| drama | çŸ­å‰§æ¨å¹¿ç½‘ç«™ |
| mixed | æ··åˆç±»å‹ç½‘ç«™ |

### 7.8 å¤šè¯­è¨€æ¨¡å¼

| i18n_mode | è¯´æ˜ | URLæ ¼å¼ç¤ºä¾‹ |
|-----------|------|------------|
| subdirectory | å­ç›®å½•æ¨¡å¼ | `/en/article/xxx` |
| subdomain | å­åŸŸåæ¨¡å¼ | `en.example.com/article/xxx` |
| query | å‚æ•°æ¨¡å¼ | `/article/xxx?lang=en` |

### 7.9 å¤šè¯­è¨€ç”Ÿæˆæ¨¡å¼

| locale_generation_mode | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|------------------------|------|---------|
| primary_only | ä»…ç”Ÿæˆä¸»è¯­è¨€ | åªéœ€è¦å•è¯­è¨€å†…å®¹ |
| translate | ç¿»è¯‘ç”Ÿæˆ | å…ˆç”Ÿæˆä¸»è¯­è¨€ï¼Œå†ç¿»è¯‘æˆå…¶ä»–è¯­è¨€ |
| parallel | å¹¶è¡Œç”Ÿæˆ | åŒæ—¶ç”Ÿæˆå¤šè¯­è¨€ç‰ˆæœ¬ |

### 7.10 å¸¸ç”¨è¯­è¨€ä»£ç 

| locale | è¯­è¨€åç§° | æœ¬åœ°åç§° |
|--------|---------|---------|
| zh-CN | ç®€ä½“ä¸­æ–‡ | ç®€ä½“ä¸­æ–‡ |
| zh-TW | ç¹ä½“ä¸­æ–‡ | ç¹é«”ä¸­æ–‡ |
| en-US | è‹±è¯­(ç¾å›½) | English |
| ja-JP | æ—¥è¯­ | æ—¥æœ¬èª |
| ko-KR | éŸ©è¯­ | í•œêµ­ì–´ |
| vi-VN | è¶Šå—è¯­ | Tiáº¿ng Viá»‡t |
| th-TH | æ³°è¯­ | à¹„à¸—à¸¢ |
| id-ID | å°å°¼è¯­ | Bahasa Indonesia |
| pt-BR | è‘¡è„ç‰™è¯­(å·´è¥¿) | PortuguÃªs |
| es-ES | è¥¿ç­ç‰™è¯­ | EspaÃ±ol |

### 7.11 äº§å“ç±»å‹

| product_type | è¯´æ˜ | å…³è”è¡¨ |
|--------------|------|--------|
| game | æ¸¸æˆ | gb_games |
| game_box | æ¸¸æˆç›’å­ | gb_game_boxes |
| drama | çŸ­å‰§ | gb_dramas |
| drama_vendor | çŸ­å‰§å‚å•† | gb_drama_vendors |

### 7.12 å­˜å‚¨ç±»å‹

| storage_type | è¯´æ˜ | è®¿é—®æ–¹å¼ |
|--------------|------|---------|
| github | GitHubä»“åº“ | `https://raw.githubusercontent.com/{owner}/{repo}/{branch}/{path}` |
| minio | MinIOå¯¹è±¡å­˜å‚¨ | `http://{endpoint}:{port}/{bucket}/{path}` |
| r2 | Cloudflare R2 | `https://{custom_domain}/{path}` |
| oss | é˜¿é‡Œäº‘OSS | `https://{bucket}.{region}.aliyuncs.com/{path}` |
| cos | è…¾è®¯äº‘COS | `https://{bucket}.cos.{region}.myqcloud.com/{path}` |
| s3 | AWS S3 / S3å…¼å®¹ | `https://{bucket}.s3.{region}.amazonaws.com/{path}` |

### 7.13 å­˜å‚¨ç”¨é€”

| storage_purpose | è¯´æ˜ | å…¸å‹åœºæ™¯ |
|-----------------|------|---------|
| article | æ–‡ç« å†…å®¹å­˜å‚¨ | Markdownæ–‡ä»¶ã€HTMLæ–‡ä»¶å­˜å‚¨ |
| resource | èµ„æºæ–‡ä»¶å­˜å‚¨ | å›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ç­‰èµ„æºæ–‡ä»¶ |
| mixed | æ··åˆå­˜å‚¨ | åŒæ—¶å­˜å‚¨æ–‡ç« å†…å®¹å’Œèµ„æºæ–‡ä»¶ |

### 7.14 å­˜å‚¨å¥åº·çŠ¶æ€

| health_status | è¯´æ˜ | å¤„ç†å»ºè®® |
|---------------|------|---------|
| unknown | æœªçŸ¥ | æœªè¿›è¡Œå¥åº·æ£€æŸ¥ |
| healthy | å¥åº· | æ­£å¸¸ä½¿ç”¨ |
| degraded | é™çº§ | éƒ¨åˆ†åŠŸèƒ½å—é™ï¼Œå»ºè®®æ£€æŸ¥ |
| unhealthy | ä¸å¥åº· | æ— æ³•ä½¿ç”¨ï¼Œéœ€è¦ä¿®å¤ |

### 7.15 å®¹é‡æ—¥å¿—ç±»å‹

| log_type | è¯´æ˜ | è§¦å‘åœºæ™¯ |
|----------|------|---------|
| upload | ä¸Šä¼ æ–‡ä»¶ | æ–°å¢æ–‡ç« ã€ä¸Šä¼ èµ„æº |
| delete | åˆ é™¤æ–‡ä»¶ | åˆ é™¤æ–‡ç« ã€ç§»é™¤èµ„æº |
| sync | åŒæ­¥æ›´æ–° | å®šæ—¶ä»»åŠ¡åŒæ­¥å®é™…å®¹é‡ |
| manual | æ‰‹åŠ¨è°ƒæ•´ | ç®¡ç†å‘˜æ‰‹åŠ¨è°ƒæ•´å®¹é‡å€¼ |

### 7.16 AIå¹³å°ä»£ç 

| platform_code | å¹³å°åç§° | å‚å•† |
|---------------|---------|------|
| openai | OpenAI GPT | OpenAI |
| claude | Claude | Anthropic |
| gemini | Gemini | Google |
| qwen | é€šä¹‰åƒé—® | é˜¿é‡Œ |
| doubao | è±†åŒ… | å­—èŠ‚ |
| wenxin | æ–‡å¿ƒä¸€è¨€ | ç™¾åº¦ |
| spark | æ˜Ÿç« | è®¯é£ |
| deepseek | DeepSeek | DeepSeek |

### 7.17 æ¸¸æˆåˆ†ç±»åˆå§‹æ•°æ®

| ID | åç§° | Slug | å›¾æ ‡ |
|----|------|------|------|
| 1 | ç»è¥ | jingying | ğŸª |
| 2 | å…»æˆ | yangcheng | ğŸŒ± |
| 3 | å†’é™© | maoxian | ğŸ—ºï¸ |
| 4 | ç„å¹» | xuanhuan | âœ¨ |
| 5 | ç§‘å¹» | kehuan | ğŸš€ |
| 6 | è¥¿æ¸¸ | xiyou | ğŸ’ |
| 7 | æŒ‚æœº | guaji | â° |
| 8 | äºŒæ¬¡å…ƒ | erciyuan | ğŸŒŸ |
| 9 | å‰²è‰ | gecao | âš¡ |
| 10 | è§’è‰²æ‰®æ¼” | juesebanyan | ğŸ‘¤ |
| 11 | å®˜æ–¹ | guanfang | ğŸ›ï¸ |
| 12 | ä¼‘é—² | xiuxian | ğŸª |
| 13 | æ­¦ä¾  | wuxia | ğŸ¥· |
| 14 | ä»™ä¾  | xianxia | ğŸ° |
| 15 | åŠ¨ä½œ | dongzuo | ğŸ’¥ |
| 16 | åŠ¨æ¼« | dongman | ğŸ“º |
| 17 | æ”¾ç½® | fangzhi | â° |
| 18 | é­”å¹» | mohuan | ğŸ”® |
| 19 | ç­–ç•¥ | celue | ğŸ¯ |
| 20 | å¡ç‰Œ | kapai | ğŸƒ |
| 21 | ä¼ å¥‡ | chuanqi | âš”ï¸ |
| 22 | å›åˆ | huihe | ğŸ² |
| 23 | ä¸‰å›½ | sanguo | ğŸ® |

### 7.18 çŸ­å‰§åˆ†ç±»åˆå§‹æ•°æ®

| ID | åç§° | Slug | å›¾æ ‡ |
|----|------|------|------|
| 101 | ç”œå®  | tianchong | ğŸ’• |
| 102 | è™æ‹ | nuelian | ğŸ’” |
| 103 | é€†è¢­ | nixi | ğŸš€ |
| 104 | ç©¿è¶Š | chuanyue | â³ |
| 105 | æ‚¬ç–‘ | xuanyi | ğŸ” |
| 106 | å¤è£… | guzhuang | ğŸ‘˜ |
| 107 | éƒ½å¸‚ | dushi | ğŸ™ï¸ |
| 108 | è±ªé—¨ | haomen | ğŸ’ |
| 109 | å¤ä»‡ | fuchou | ğŸ”¥ |
| 110 | é‡ç”Ÿ | chongsheng | ğŸ”„ |

### 7.19 æç¤ºè¯æ¨¡æ¿ç±»å‹

| template_type | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|---------------|------|---------|
| game_intro | æ¸¸æˆä»‹ç» | ç”Ÿæˆæ¸¸æˆç®€ä»‹ã€å–ç‚¹æè¿° |
| game_guide | æ¸¸æˆæ”»ç•¥ | ç”Ÿæˆæ–°æ‰‹æ”»ç•¥ã€è¿›é˜¶æ•™ç¨‹ |
| game_review | æ¸¸æˆè¯„æµ‹ | ç”Ÿæˆæ¸¸æˆæµ‹è¯„æ–‡ç«  |
| game_news | æ¸¸æˆèµ„è®¯ | ç”Ÿæˆæ¸¸æˆæ–°é—»ã€æ›´æ–°æ—¥å¿— |
| drama_intro | çŸ­å‰§ä»‹ç» | ç”ŸæˆçŸ­å‰§ç®€ä»‹ã€çœ‹ç‚¹ |
| drama_review | çŸ­å‰§è¯„æµ‹ | ç”ŸæˆçŸ­å‰§æµ‹è¯„ |
| seo_article | SEOè½¯æ–‡ | ç”ŸæˆSEOä¼˜åŒ–æ–‡ç«  |
| promotion | æ¨å¹¿æ–‡æ¡ˆ | ç”Ÿæˆæ¨å¹¿è¥é”€æ–‡æ¡ˆ |
| custom | è‡ªå®šä¹‰ | ç”¨æˆ·è‡ªå®šä¹‰æ¨¡æ¿ |

### 7.20 æ–‡ç« èµ„æºç±»å‹

| resource_type | è¯´æ˜ | å¸¸è§æ ¼å¼ |
|---------------|------|---------|
| image | å›¾ç‰‡ | jpg, png, gif, webp |
| video | è§†é¢‘ | mp4, webm, m3u8 |
| audio | éŸ³é¢‘ | mp3, wav, ogg |
| file | å…¶ä»–æ–‡ä»¶ | pdf, zip, etc |

### 7.21 èµ„æºè¿ç§»çŠ¶æ€

| migration_status | è¯´æ˜ | åç»­æ“ä½œ |
|------------------|------|---------|
| none | æœªè¿ç§»/åŸå§‹çŠ¶æ€ | å¯å‘èµ·è¿ç§» |
| pending | å¾…è¿ç§» | ç­‰å¾…ä»»åŠ¡æ‰§è¡Œ |
| migrating | è¿ç§»ä¸­ | å¤„ç†ä¸­ï¼Œè¯·å‹¿é‡å¤æäº¤ |
| completed | è¿ç§»å®Œæˆ | æ— éœ€æ“ä½œ |
| failed | è¿ç§»å¤±è´¥ | æŸ¥çœ‹æ—¥å¿—ï¼Œé‡è¯• |

### 7.22 å­˜å‚¨è¿ç§»è§„åˆ™ç±»å‹

| rule_type | è¯´æ˜ | å…¸å‹ç”¨é€” |
|-----------|------|---------|
| url_replace | URLæ›¿æ¢ | åŸŸåæ›´æ¢ã€CDNåˆ‡æ¢ |
| storage_move | å­˜å‚¨è¿ç§» | è·¨å­˜å‚¨å•†è¿ç§»èµ„æºæ–‡ä»¶ |
| path_rewrite | è·¯å¾„é‡å†™ | ç›®å½•ç»“æ„è°ƒæ•´ |
| domain_change | åŸŸåæ›´æ¢ | ä»…æ›´æ¢è®¿é—®åŸŸå |

---

## 8. ç´¢å¼•ä¼˜åŒ–å»ºè®®

### 8.1 MySQL ç´¢å¼•ç­–ç•¥

```sql
-- å¤åˆç´¢å¼•ä¼˜åŒ–æœç´¢æŸ¥è¯¢
CREATE INDEX idx_doc_site_category_published ON gb_documents(site_id, category_id, is_published, published_at DESC);

-- æ–‡ç« æŒ‰å‘å¸ƒæ—¥æœŸåˆ†ç±»ç´¢å¼•
CREATE INDEX idx_article_site_date ON gb_articles(site_id, publish_year, publish_month, is_published);

-- æ¸¸æˆç›’å­-æ¸¸æˆå…³è”æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_box_game_featured ON gb_box_game_relations(box_id, is_featured, sort_order);

-- æ¸¸æˆæŒ‰ç±»å‹å’Œä¸Šæ¶æ—¶é—´æŸ¥è¯¢
CREATE INDEX idx_game_type_launch ON gb_games(site_id, game_type, launch_time DESC);

-- æ¸¸æˆç¤¼åŒ…æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_giftcode_game_type ON gb_game_giftcodes(game_id, gift_type, status);

-- æ¸¸æˆæ´»åŠ¨æ—¶é—´èŒƒå›´æŸ¥è¯¢
CREATE INDEX idx_activity_time ON gb_game_activities(game_id, start_time, end_time);

-- å¼€æœæ—¶é—´æŸ¥è¯¢
CREATE INDEX idx_server_open_time ON gb_game_servers(game_id, open_time DESC);

-- æ–‡ç« äº§å“å…³è”æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_article_product ON gb_article_product_relations(product_type, product_id);

-- ç»Ÿè®¡æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_pv_site_date_content ON gb_page_views(site_id, created_at, content_type, content_id);

-- AIç”Ÿæˆè®°å½•æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_generation_article_version ON gb_article_generations(article_id, generation_version DESC);

-- çƒ­è¯æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_hot_site_date_count ON gb_hot_keywords(site_id, stat_date DESC, search_count DESC);

-- çŸ­å‰§æŒ‰çƒ­é—¨/æ–°å‰§æŸ¥è¯¢ä¼˜åŒ–
CREATE INDEX idx_drama_hot_new ON gb_dramas(site_id, is_hot, is_new, sort_order);
```

### 8.2 åˆ†åŒºç­–ç•¥

```sql
-- é¡µé¢æµè§ˆè¡¨æŒ‰æœˆåˆ†åŒº
ALTER TABLE gb_page_views PARTITION BY RANGE (TO_DAYS(created_at)) (
    PARTITION p202501 VALUES LESS THAN (TO_DAYS('2025-02-01')),
    PARTITION p202502 VALUES LESS THAN (TO_DAYS('2025-03-01')),
    PARTITION p202503 VALUES LESS THAN (TO_DAYS('2025-04-01')),
    -- ... æ›´å¤šåˆ†åŒº
    PARTITION p_future VALUES LESS THAN MAXVALUE
);

-- AIç”Ÿæˆè®°å½•è¡¨æŒ‰æœˆåˆ†åŒº
ALTER TABLE gb_article_generations PARTITION BY RANGE (TO_DAYS(created_at)) (
    PARTITION p202501 VALUES LESS THAN (TO_DAYS('2025-02-01')),
    PARTITION p202502 VALUES LESS THAN (TO_DAYS('2025-03-01')),
    PARTITION p202503 VALUES LESS THAN (TO_DAYS('2025-04-01')),
    PARTITION p_future VALUES LESS THAN MAXVALUE
);
```

---

## 9. è¡¨å…³ç³»æ±‡æ€»

### 9.1 å®Œæ•´è¡¨æ¸…å•

| åºå· | è¡¨å | è¯´æ˜ | æ‰€å±åº“ |
|------|------|------|--------|
| 1 | gb_sites | ç½‘ç«™è¡¨ | product_content |
| 2 | gb_storage_configs | å¯¹è±¡å­˜å‚¨é…ç½®è¡¨ | product_content |
| 3 | gb_documents | æ–‡æ¡£è¡¨ | product_content |
| 4 | gb_categories | åˆ†ç±»è¡¨ | product_content |
| 5 | gb_games | æ¸¸æˆè¡¨ | product_content |
| 6 | gb_game_boxes | æ¸¸æˆç›’å­è¡¨ | product_content |
| 7 | gb_box_game_relations | æ¸¸æˆç›’å­-æ¸¸æˆå…³è”è¡¨ | product_content |
| 8 | gb_game_activities | æ¸¸æˆæ´»åŠ¨è¡¨ | product_content |
| 9 | gb_game_servers | æ¸¸æˆå¼€æœè¡¨ | product_content |
| 10 | gb_game_giftcodes | æ¸¸æˆç¤¼åŒ…è¡¨ | product_content |
| 11 | gb_game_materials | æ¸¸æˆç´ æè¡¨ | product_content |
| 12 | gb_document_game_relations | æ–‡æ¡£-æ¸¸æˆå…³è”è¡¨ | product_content |
| 13 | gb_tags | æ ‡ç­¾è¡¨ | product_content |
| 14 | gb_document_tags | æ–‡æ¡£-æ ‡ç­¾å…³è”è¡¨ | product_content |
| 15 | gb_drama_vendors | çŸ­å‰§å‚å•†è¡¨ | product_content |
| 16 | gb_dramas | çŸ­å‰§è¡¨ | product_content |
| 17 | gb_ai_platforms | AIå¹³å°é…ç½®è¡¨ | product_content |
| 18 | gb_prompt_templates | æç¤ºè¯æ¨¡æ¿è¡¨ | product_content |
| 19 | gb_articles | æ–‡ç« è¡¨ | product_content |
| 20 | gb_article_generations | æ–‡ç« ç”Ÿæˆè®°å½•è¡¨ | product_content |
| 21 | gb_article_resources | æ–‡ç« èµ„æºè¡¨ | product_content |
| 22 | gb_article_product_relations | æ–‡ç« -äº§å“å…³è”è¡¨ | product_content |
| 23 | gb_storage_migration_rules | å­˜å‚¨è¿ç§»è§„åˆ™è¡¨ | product_content |
| 24 | gb_storage_migration_logs | å­˜å‚¨è¿ç§»æ—¥å¿—è¡¨ | product_content |
| 25 | gb_storage_capacity_logs | å­˜å‚¨å®¹é‡ä½¿ç”¨è®°å½•è¡¨ | product_content |
| 26 | gb_ai_batch_tasks | AIç”Ÿæˆæ‰¹é‡ä»»åŠ¡è¡¨ | product_content |
| 27 | gb_ai_task_executions | AIä»»åŠ¡æ‰§è¡Œè®°å½•è¡¨ | product_content |
| 28 | gb_ai_task_execution_items | AIä»»åŠ¡æ‰§è¡Œè¯¦æƒ…è¡¨ | product_content |
| 29 | gb_github_repos | GitHubä»“åº“é…ç½®è¡¨ | product_content |
| 30 | gb_site_locales | ç½‘ç«™è¯­è¨€é…ç½®è¡¨ | product_content |
| 31 | gb_search_logs | æœç´¢æ—¥å¿—è¡¨ | product_analytics |
| 32 | gb_page_views | é¡µé¢æµè§ˆè¡¨ | product_analytics |
| 33 | gb_daily_stats | æ¯æ—¥ç»Ÿè®¡æ±‡æ€»è¡¨ | product_analytics |
| 34 | gb_hot_keywords | çƒ­é—¨æœç´¢è¯è¡¨ | product_analytics |
| 35 | gb_ai_generation_stats | AIç”Ÿæˆç»Ÿè®¡è¡¨ | product_analytics |

### 9.2 æ ¸å¿ƒå®ä½“å…³ç³»

```mermaid
graph TB
    subgraph ç½‘ç«™å±‚
        SITE[gb_sites<br/>ç½‘ç«™]
        LOCALE[gb_site_locales<br/>è¯­è¨€é…ç½®]
    end
    
    subgraph äº§å“å±‚
        GAMEBOX[gb_game_boxes<br/>æ¸¸æˆç›’å­]
        GAME[gb_games<br/>æ¸¸æˆ]
        VENDOR[gb_drama_vendors<br/>çŸ­å‰§å‚å•†]
        DRAMA[gb_dramas<br/>çŸ­å‰§]
    end
    
    subgraph å†…å®¹å±‚
        DOC[gb_documents<br/>æ–‡æ¡£]
        ARTICLE[gb_articles<br/>æ–‡ç« ]
        ART_RES[gb_article_resources<br/>æ–‡ç« èµ„æº]
    end
    
    subgraph é…ç½®å±‚
        STORAGE[gb_storage_configs<br/>å­˜å‚¨é…ç½®]
        AI[gb_ai_platforms<br/>AIå¹³å°]
        PROMPT[gb_prompt_templates<br/>æç¤ºè¯æ¨¡æ¿]
        MIGRATE[gb_storage_migration_rules<br/>è¿ç§»è§„åˆ™]
        GITHUB[gb_github_repos<br/>GitHubä»“åº“]
    end
    
    subgraph AIä»»åŠ¡å±‚
        BATCH[gb_ai_batch_tasks<br/>æ‰¹é‡ä»»åŠ¡]
        EXEC[gb_ai_task_executions<br/>æ‰§è¡Œè®°å½•]
        ITEM[gb_ai_task_execution_items<br/>æ‰§è¡Œè¯¦æƒ…]
    end
    
    subgraph å…³è”å±‚
        BOX_GAME[gb_box_game_relations]
        DOC_GAME[gb_document_game_relations]
        ART_PROD[gb_article_product_relations]
        ART_GEN[gb_article_generations]
    end
    
    SITE --> LOCALE
    SITE --> GAMEBOX
    SITE --> GAME
    SITE --> VENDOR
    SITE --> DRAMA
    SITE --> DOC
    SITE --> ARTICLE
    SITE --> PROMPT
    SITE --> BATCH
    SITE -.-> GITHUB
    
    LOCALE -->|å­˜å‚¨è§„åˆ™| STORAGE
    ARTICLE -->|è¯­è¨€ç‰ˆæœ¬| LOCALE
    
    GAMEBOX <-->|M:N| BOX_GAME
    GAME <-->|M:N| BOX_GAME
    
    DOC <-->|M:N| DOC_GAME
    GAME <-->|M:N| DOC_GAME
    
    ARTICLE <-->|M:N| ART_PROD
    ARTICLE -->|æ‹¥æœ‰| ART_RES
    ARTICLE -->|ä½¿ç”¨| PROMPT
    ARTICLE -->|ç¿»è¯‘ç‰ˆæœ¬| ARTICLE
    GAME -.->|è¢«å…³è”| ART_PROD
    GAMEBOX -.->|è¢«å…³è”| ART_PROD
    DRAMA -.->|è¢«å…³è”| ART_PROD
    
    ARTICLE -->|ç”Ÿæˆè®°å½•| ART_GEN
    ART_GEN -->|ä½¿ç”¨| AI
    ART_GEN -->|ä½¿ç”¨| PROMPT
    
    DOC -->|ä½¿ç”¨| STORAGE
    ARTICLE -->|ä½¿ç”¨| STORAGE
    ART_RES -->|å­˜å‚¨äº| STORAGE
    
    MIGRATE -->|è¿ç§»| ART_RES
    
    VENDOR -->|1:N| DRAMA
    
    %% AIä»»åŠ¡å…³ç³»
    BATCH -->|è§¦å‘| EXEC
    BATCH -->|ä½¿ç”¨| GITHUB
    BATCH -->|ç›®æ ‡è¯­è¨€| LOCALE
    EXEC -->|åŒ…å«| ITEM
    ITEM -.->|ç”Ÿæˆ| ARTICLE
```

---

## 10. é™„å½•

### 10.1 ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®æ”¹å†…å®¹ |
|------|------|---------|
| v1.0.0 | 2025-12-13 | åˆå§‹ç‰ˆæœ¬ï¼Œæ¸¸æˆç›’å­åŸºç¡€è¡¨è®¾è®¡ |
| v2.0.0 | 2025-12-14 | æ‰©å±•æ”¯æŒå¤šç½‘ç«™ã€çŸ­å‰§äº§å“ã€AIæ–‡ç« ç”Ÿæˆã€å¤šç§å¯¹è±¡å­˜å‚¨ |
| v2.1.0 | 2025-12-14 | å®Œå–„æ¸¸æˆæ¨å¹¿æ•°æ®ï¼šæ´»åŠ¨ã€å¼€æœã€ç¤¼åŒ…ã€ç´ æè¡¨ï¼›ä¼˜åŒ–æŠ˜æ‰£å’Œæ¨å¹¿é“¾æ¥å­—æ®µ |
| v2.2.0 | 2025-12-14 | æ–°å¢æç¤ºè¯æ¨¡æ¿ç®¡ç†ï¼ˆgb_prompt_templatesï¼‰ï¼›æ–°å¢æ–‡ç« èµ„æºç®¡ç†ï¼ˆgb_article_resourcesï¼‰æ”¯æŒå›¾ç‰‡/è§†é¢‘å­˜å‚¨ï¼›æ–°å¢å­˜å‚¨è¿ç§»è§„åˆ™ï¼ˆgb_storage_migration_rulesï¼‰å’Œè¿ç§»æ—¥å¿—ï¼ˆgb_storage_migration_logsï¼‰æ”¯æŒæ‰¹é‡èµ„æºè¿ç§» |
| v2.3.0 | 2025-12-14 | æ¶æ„é™çº§ä¸ºå•ä½“æ¶æ„ï¼Œç§»é™¤å¾®æœåŠ¡ç›¸å…³é…ç½® |
| v2.4.0 | 2025-12-14 | æ–°å¢AIæ‰¹é‡ä»»åŠ¡è¡¨ï¼ˆgb_ai_batch_tasksï¼‰ã€ä»»åŠ¡æ‰§è¡Œè®°å½•è¡¨ï¼ˆgb_ai_task_executionsï¼‰ã€æ‰§è¡Œè¯¦æƒ…è¡¨ï¼ˆgb_ai_task_execution_itemsï¼‰ã€GitHubä»“åº“é…ç½®è¡¨ï¼ˆgb_github_reposï¼‰ï¼Œæ”¯æŒGitHub Action AIæ–‡ç« ç”Ÿæˆ |
| v2.5.0 | 2025-12-14 | ä¼˜åŒ–å¤šç«™ç‚¹æ¶æ„æ”¯æŒï¼šAIæ‰¹é‡ä»»åŠ¡è¡¨æ·»åŠ site_idå­—æ®µï¼›GitHubä»“åº“é…ç½®è¡¨æ·»åŠ site_idå­—æ®µæ”¯æŒä¸åŒç«™ç‚¹ç‹¬ç«‹é…ç½®ï¼›ä¿®å¤è¡¨ç¼–å·é‡å¤é—®é¢˜ |
| v2.6.0 | 2025-12-14 | æ–°å¢å¤šè¯­è¨€æ”¯æŒï¼šç½‘ç«™è¡¨æ·»åŠ å¤šè¯­è¨€é…ç½®å­—æ®µï¼ˆdefault_locale, supported_locales, i18n_modeï¼‰ï¼›æ–°å¢ç½‘ç«™è¯­è¨€é…ç½®è¡¨ï¼ˆgb_site_localesï¼‰æ”¯æŒä¸åŒè¯­è¨€çš„å­˜å‚¨è§„åˆ™å’Œå‘å¸ƒé“¾æ¥é…ç½®ï¼›æ–‡ç« è¡¨æ·»åŠ localeå’Œmaster_article_idå­—æ®µæ”¯æŒå¤šè¯­è¨€ç‰ˆæœ¬ï¼›AIæ‰¹é‡ä»»åŠ¡è¡¨æ·»åŠ target_localeså’Œlocale_generation_modeå­—æ®µï¼›AIæ‰§è¡Œè¯¦æƒ…è¡¨æ·»åŠ localeå’Œç¿»è¯‘ç›¸å…³å­—æ®µ |
| v2.7.0 | 2025-12-14 | å®Œå–„å¯¹è±¡å­˜å‚¨é…ç½®ï¼šå­˜å‚¨é…ç½®è¡¨æ·»åŠ ç«™ç‚¹å…³è”ã€å®¹é‡ç®¡ç†ã€ä¼˜å…ˆçº§è½®æ¢ã€å¥åº·æ£€æŸ¥ç­‰å­—æ®µï¼›æ–°å¢å­˜å‚¨å®¹é‡ä½¿ç”¨è®°å½•è¡¨ï¼ˆgb_storage_capacity_logsï¼‰æ”¯æŒå®¹é‡å˜åŒ–è¿½è¸ªï¼›æ”¯æŒå­˜å‚¨æ»¡åè‡ªåŠ¨åˆ‡æ¢å¤‡ç”¨å­˜å‚¨ï¼›æ–°å¢é˜¿é‡Œäº‘OSSå’Œè…¾è®¯äº‘COSé…ç½®å­—æ®µ |

### 10.2 å¾…æ‰©å±•åŠŸèƒ½

- [ ] ç”¨æˆ·è¯„è®ºè¡¨è®¾è®¡
- [ ] è®¢å•/æ”¯ä»˜ç›¸å…³è¡¨è®¾è®¡
- [ ] æ¨å¹¿è¿½è¸ª/æ¸ é“ç»Ÿè®¡è¡¨è®¾è®¡
- [ ] æ¨å¹¿å‘˜ç®¡ç†è¡¨è®¾è®¡
- [x] ~~å¤šè¯­è¨€æ”¯æŒè¡¨è®¾è®¡~~ (v2.6.0 å·²å®Œæˆ)
- [x] ~~å¤šå¯¹è±¡å­˜å‚¨é…ç½®ä¸å®¹é‡ç®¡ç†~~ (v2.7.0 å·²å®Œæˆ)
- [ ] ç¤¼åŒ…é¢†å–è®°å½•è¡¨è®¾è®¡
